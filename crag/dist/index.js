var Rr=Object.defineProperty;var c=(Le,A)=>Rr(Le,"name",{value:A,configurable:!0});(function(){"use strict";const Le=`*,:after,:before{box-sizing:border-box}.icon-nightmode-toggle{position:absolute;right:5pt;top:5pt;display:inline-block;background-color:#00000064;cursor:pointer;width:var(--icon-size);height:var(--icon-size);-webkit-mask-size:var(--icon-size) var(--icon-size);-webkit-mask-repeat:no-repeat;-webkit-mask-position:center;mask-size:var(--icon-size) var(--icon-size);mask-repeat:no-repeat;mask-position:center;mask:url(/assets/moon.svg);-webkit-mask:url(/assets/moon.svg)}.icon-nightmode-toggle:focus{background-color:var(--flash-color)}input[type=search]::-webkit-search-decoration,input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-results-button,input[type=search]::-webkit-search-results-decoration{display:none}ukc-searchbar{margin-bottom:12px;transition:all}.nightmode .icon-nightmode-toggle{width:var(--icon-size);height:var(--icon-size);-webkit-mask-size:var(--icon-size) var(--icon-size);-webkit-mask-repeat:no-repeat;-webkit-mask-position:center;mask-size:var(--icon-size) var(--icon-size);mask-repeat:no-repeat;mask-position:center;mask:url(/assets/sun.svg);-webkit-mask:url(/assets/sun.svg);background-color:#ffffff7d}.nightmode .rfd-search{--background-color-page: #19181f;--background-color-page-semi: #19181fa5;--brightness-multiplier: 100%;--background-color: #282630;--background-color-2: var(--background-color-page-semi);--title-color: rgb(217, 217, 217);--subtitle-color: rgba(255, 255, 255, .62);--subtitle-color-2: rgba(255, 255, 255, .492);--subtitle-color-3: rgba(255, 255, 255, .39);--subtitle-color-4: rgba(255, 255, 255, .28);--flash-color: hotpink;--border-color: #565656}.nightmode .rfd-search logbook-result .result-entry-container{border-bottom:solid #212029 1px}.nightmode .rfd-search page-button{background-color:var(--background-color);color:var(--subtitle-color-2)}.nightmode .rfd-search .page-control-current{color:var(--subtitle-color-2);background-color:var(--background-color-2)}.nightmode .rfd-search #page-control-next.disabled,.nightmode .rfd-search #page-control-previous.disabled{background-color:var(--background-color)}.nightmode .rfd-search #search-widget{box-shadow:0 0 10px #01010133}.nightmode .rfd-search .gray-background input{background-color:var(--background-color)}@media (hover: hover) and (pointer: fine){.nightmode .icon-nightmode-toggle:hover{background-color:var(--flash-color)}.nightmode .result-entry:hover{border-radius:calc(var(--radius) * .7)}.nightmode .mouse-over:hover{color:var(--flash-color)}.nightmode .icon:hover{background-color:var(--flash-color)}.nightmode .result-entry-container:hover{background-color:var(--background-color-2)}.nightmode .page-control-page:hover{border-color:var(--flash-color);color:var(--flash-color);z-index:2}.nightmode .page-control-current:hover{border-color:var(--background-color-2);color:var(--subtitle-color-2);z-index:2}.nightmode #page-control-next.disabled:hover,.nightmode #page-control-previous.disabled:hover{color:var(--subtitle-color-2)}.nightmode #page-control-next:hover,.nightmode #page-control-previous:hover{border-color:var(--flash-color);color:var(--flash-color);z-index:2}.nightmode a:hover,.nightmode .page-control-page:hover{color:var(--flash-color)}.nightmode .page-control-current:hover,.nightmode #page-control-next.disabled:hover,.nightmode #page-control-previous.disabled:hover{color:var(--subtitle-color-2)}}html{--background-color-page: #e8e8e8;--base-mask-size: 2rem;--icon-size: var(--base-mask-size);--big-screen-multiplier: .45}.rfd-search{--background-color-page-semi: #eeeeef;--brightness-multiplier: 100%;--background-color: white;--background-color-2: #dadada;--title-color: rgba(0, 0, 0, .75);--subtitle-color: rgba(0, 0, 0, .65);--subtitle-color-2: rgba(0, 0, 0, .5);--subtitle-color-3: rgba(0, 0, 0, .45);--subtitle-color-4: rgba(0, 0, 0, .35);--flash-color: var(--flash-color);--border-color: #444444;--base-padding: 10pt;--base-font-size: 1.1rem;--base-font-size-2: calc(var(--base-font-size) * .9);--base-font-size-3: calc(var(--base-font-size-2) * .9);--base-font-size-4: calc(var(--base-font-size-3) * 1);--base-result-icon-size: 1.7rem;--padding: var(--base-padding);--font-size: var(--base-font-size);--font-size-2: var(--base-font-size-2);--font-size-3: var(--base-font-size-3);--font-size-4: var(--base-font-size-4);--page-control-font-size: 1.3rem;--page-control-size: calc(var(--page-control-font-size) * 1.8);--result-icon-size: var(--base-result-icon-size);--radius: 10pt;--radius-search-results: 0pt;--border-width: 1pt;--search-container-z-index: 1030;--gray-view-opacity-animation-duration: .2s;margin-bottom:16px}.rfd-search crag-icon *,.rfd-search topo-dot *,.rfd-search external-link-icon *{width:var(--result-icon-size);height:var(--result-icon-size)}.rfd-search select{background-color:var(--background-color);color:var(--subtitle-color);border:none}.rfd-search{width:100%;font-size:var(--font-size);position:relative}.rfd-search ::-webkit-scrollbar-thumb{filter:brightness(80%)}.rfd-search #searchbar-footer,.rfd-search #searchbar-query-suggestion-flex{filter:brightness(90%)}.rfd-search ::-webkit-scrollbar{height:10pt;width:5pt}.rfd-search ::-webkit-scrollbar-thumb{background:var(--background-color-2)}.rfd-search ::-webkit-scrollbar-track{background:rgba(1,1,1,0)}.rfd-search scrollbar-thumb{background:var(--background-color-2)}.rfd-search scrollbar-track{background:rgba(1,1,1,0)}.rfd-search ul{list-style-type:none;margin:0;padding:0;padding-bottom:var(--padding);outline:none}.rfd-search ul a:link,.rfd-search ul a:visited,.rfd-search ul a:hover,.rfd-search ul a:active{color:unset}.rfd-search input{outline:none;width:100%;font-size:var(--font-size);border-radius:var(--radius);color:#0000;background-color:var(--background-color);color:var(--title-color);border:none;transition-property:all}.rfd-search a{text-decoration:none!important}.rfd-search a:link,.rfd-search a:visited{color:#5f9ea0}.rfd-search a:active{color:var(--flash-color)}.rfd-search #name-dash{display:none}.rfd-search .logged-clean logbook-indicator,.rfd-search .logged-followed logbook-indicator,.rfd-search .logged-dogged logbook-indicator{display:block}.rfd-search .on-wishlist wishlist-indicator{display:block}.rfd-search .logged-clean.on-wishlist wishlist-indicator,.rfd-search .logged-followed.on-wishlist wishlist-indicator,.rfd-search .logged-dogged.on-wishlist wishlist-indicator{right:24px}.rfd-search logbook-indicator{display:none;position:absolute;top:0;right:-6px;width:calc(var(--result-icon-size) * 1);height:calc(var(--result-icon-size) * 1)}.rfd-search wishlist-indicator{display:none;position:absolute;top:-1px;right:4px;width:calc(var(--result-icon-size) * .5);height:calc(var(--result-icon-size) * .5)}.rfd-search input,.rfd-search #search-query-description,.rfd-search .search-results-search-query-description{padding:calc(var(--padding) * .65);padding-left:var(--padding)}.rfd-search #filter-icon{left:16px;position:absolute;top:50%;transform:translateY(-50%);background-color:var(--subtitle-color)}.rfd-search #filter-bar-container input{width:calc(100% - (var(--padding) * 2 - 8px));display:block;padding:var(--padding);padding-top:calc(var(--padding) - 2px);padding-bottom:calc(var(--padding) - 2px);padding-left:40px;margin:var(--padding);margin-right:calc(var(--padding) - 4px);margin-left:calc(var(--padding) - 4px);border-width:var(--border-width);border-radius:var(--radius);background-color:var(--background-color-page-semi);transition:all .3s}.rfd-search #name-and-grade{display:flex;justify-content:space-between;font-weight:500}.rfd-search #gray-view{width:100vw;height:100vh;background-color:#000000b3;position:fixed;top:0vw;left:0vw;z-index:calc(var(--search-container-z-index) - 1);opacity:1;backdrop-filter:blur(5px);-webkit-backdrop-filter:blur(5px)}.rfd-search #search-container{position:relative;z-index:var(--search-container-z-index)}.rfd-search #search-container input{padding-right:calc(var(--icon-size) + var(--padding));padding-left:calc(var(--icon-size) + var(--padding) - 4px);transition:all .2s}.rfd-search #searchbar-inner-container{position:relative}.rfd-search #search-absolute{position:absolute;top:0;width:100%;transition:transform .3s ease-out}.rfd-search #search-widget,.rfd-search #search-results-widget{margin-bottom:var(--padding);border-width:var(--border-width);border-radius:var(--radius);background-color:var(--background-color);transition:all .3s;overflow:hidden}.rfd-search #search-widget{box-shadow:0 0 10px #0101011a;transition:opacity .3s}.rfd-search #search-results-widget{border-radius:var(--radius-search-results);margin-left:calc(-50vw + 50%);margin-right:calc(-51vw + 51%)}.rfd-search #searchbar-footer{background-color:var(--background-color);font-size:var(--font-size-4);color:var(--subtitle-color-2);border-bottom-left-radius:var(--radius);border-bottom-right-radius:var(--radius);filter:brightness(90%)}.rfd-search #search-results-container{contain:layout paint;overflow-y:auto;overflow-x:hidden;overscroll-behavior-y:contain;scrollbar-color:var(--background-color-2) rgba(1,1,1,0);transition:opacity .3s ease-out}.rfd-search #search-icon{position:absolute;left:4pt;top:50%;transform:translateY(-50%);background-color:var(--subtitle-color)}.rfd-search #filter-bar-container{position:relative}.rfd-search #input-hidden{background-color:#0000!important}.rfd-search #delete-search-text-button,.rfd-search #filter-delete-text-button{position:absolute;right:0;top:50%;transform:translateY(-50%);cursor:pointer}.rfd-search #filter-delete-text-button{right:10px}.rfd-search #return-key-action{padding:var(--padding);margin-top:calc(var(--padding) * 5)}.rfd-search #search-results-header-container{background-color:var(--background-color);position:sticky;z-index:1;width:100vw;margin-left:-15px}.rfd-search .ukc-search-results-header{padding-left:var(--padding);width:100vw}.rfd-search .result-icon{display:inline-block}.rfd-search .gray-background input{background-color:#e0e0e0;transition:background-color .2s ease}.rfd-search .normal-background input{background-color:var(--background-color);transition:background-color .2s ease}.rfd-search .searchbar-help-text-container{transition:height .2s ease;overscroll-behavior-y:contain}.rfd-search #searchbar-help-text{padding:calc(var(--padding) * 2)}.rfd-search #placeholder-short-display{color:var(--title-color);opacity:.5;margin-left:-6px}.rfd-search #searchbar-short-display-container{position:absolute;left:4pt;transform:translateY(-8%)}.rfd-search #search-icon-short-display{background-color:var(--subtitle-color);display:inline-block;transform:translateY(30%)}.rfd-search #searchbar-query-suggestion-flex{position:relative;padding-right:calc(var(--icon-size) + var(--padding));border-bottom-left-radius:var(--radius);border-bottom-right-radius:var(--radius)}.rfd-search .ascent-notes a,.rfd-search .ascent-details a{color:#bbdcee!important;opacity:.7;line-height:1.3em}.rfd-search #help-button,.rfd-search #filter-bar-help-button{position:absolute;right:0;top:50%;transform:translateY(-50%)}.rfd-search #searchbar-query-suggestion-flex,.rfd-search #search-query-description,.rfd-search .search-results-search-query-description{font-size:var(--font-size-3);color:var(--subtitle-color-2);background-color:var(--background-color)}.rfd-search #focus-searchbar{display:none}.rfd-search .logged{background-color:green}.rfd-search .page-control{display:flex;justify-content:flex-end;align-content:center;margin-bottom:var(--padding);margin-left:calc(-50vw + 50%);margin-right:calc(-50vw + 50% + var(--padding))}.rfd-search .fa-button{border:0;width:40px;height:40px;background-color:var(--background-color);border-radius:var(--radius);color:var(--subtitle-color);transition:background-color .2s ease-out}.rfd-search .fa-button:hover{background-color:var(--background-color-2)}.rfd-search .fa-button i{transition:rotate .2s ease-out}.rfd-search .hidden{display:none}.rfd-search #page-control-previous,.rfd-search #page-control-next,.rfd-search page-button{display:flex;align-items:center;text-align:center;aspect-ratio:1/1;font-family:monospace;background-color:var(--background-color);border:solid;color:var(--subtitle-color-2);margin-left:calc(var(--border-width) * -1);border-width:var(--border-width);border-color:var(--background-color-2);justify-content:center;font-weight:900;cursor:pointer;font-size:var(--page-control-font-size);height:var(--page-control-size);width:var(--page-control-size)}.rfd-search #page-control-previous{border-top-left-radius:var(--radius);border-bottom-left-radius:var(--radius)}.rfd-search #page-control-next{border-top-right-radius:var(--radius);border-bottom-right-radius:var(--radius)}.rfd-search page-button{display:flex;justify-content:center;align-content:center}.rfd-search .date-header{display:flex;justify-content:space-between;font-size:var(--font-size-3);color:var(--subtitle-color-2);padding:var(--padding);padding-right:calc(var(--padding) / 2);padding-top:calc(var(--padding) / 2);padding-bottom:calc(var(--padding) / 2 - 2px);background-color:var(--background-color-page-semi)}.rfd-search .page-control-current{border-color:var(--background-color-2);color:var(--subtitle-color-2);background-color:var(--background-color-2);filter:brightness(110%);cursor:default}.rfd-search #page-control-next.disabled,.rfd-search #page-control-previous.disabled{background-color:var(--background-color);border-color:var(--background-color-2);cursor:default;opacity:.4}.rfd-search .ukc-search-results-controls{color:var(--subtitle-color-2);font-size:.9em;display:flex;justify-content:flex-start;align-items:center;margin-bottom:0}.rfd-search .ukc-search-results-sort-order{flex-grow:0;font-family:monospace;font-weight:600;margin-bottom:0;margin-left:-.3em}.rfd-search .result-entry{display:flex}.rfd-search .result-icon-area{margin-top:-4pt;width:30pt}.rfd-search .ascent-details{display:flex;justify-content:space-between;margin-top:10px;color:var(--subtitle-color-4);font-size:calc(var(--font-size-4) * .9)}.rfd-search .ascent-notes{margin-top:14px;margin-bottom:18px;font-style:italic;line-height:calc(var(--font-size-4) * 1.2);color:var(--subtitle-color-2);font-size:calc(var(--font-size-4) * .9)}.rfd-search .result-text-area{width:100%;max-width:calc(100% - 36px);display:flex;flex-direction:column}.rfd-search .result-title{overflow-x:clip;text-overflow:ellipsis;white-space:pre}.rfd-search .result-crag-name{overflow-x:clip;text-overflow:ellipsis}.rfd-search .result-entry-start{margin-bottom:6pt;display:block}.rfd-search .result-entry-end{display:flex;align-items:baseline}.rfd-search .selected .result-entry,.rfd-search .selected .result-entry *{background-color:var(--background-color-2)}.rfd-search .footer-content{padding:10px}.rfd-search .keycode{display:none;background-color:var(--background-color-2);border-radius:3pt;padding:4pt}.rfd-search .display-if-necessary{display:block}.rfd-search .result-entry{font-size:var(--font-size-2);color:var(--title-color);padding:var(--padding);padding-top:calc(var(--padding) + 4px);padding-bottom:calc(var(--padding) + 2px);display:flex}.rfd-search .result-entry-end,.rfd-search .result-entry-start{white-space:nowrap}.rfd-search .result-grade{font-size:var(--font-size-3);font-style:italic;color:var(--subtitle-color);white-space:pre}.rfd-search .result-star-count{font-size:var(--font-size-2);font-style:italic;font-weight:bolder;color:#ff69b4}.rfd-search .result-crag-name{font-size:var(--font-size-4);color:var(--subtitle-color-2)}.rfd-search .result-context,.rfd-search .result-sub-context{font-style:italic;font-size:var(--font-size-4);color:var(--subtitle-color-4)}.rfd-search .search-container{background-color:none}.rfd-search .loader-stopped,.rfd-search .divider{opacity:1;height:var(--border-width);background-color:var(--background-color-2)}.rfd-search .divider-no-height-set{opacity:1;background-color:var(--background-color-2)}.rfd-search .icon{background-color:var(--subtitle-color);margin-right:4pt;cursor:pointer}.rfd-search .icon:focus{background-color:var(--flash-color)}.rfd-search .icon-magnifying-glass{width:var(--icon-size);height:var(--icon-size);-webkit-mask-size:var(--icon-size) var(--icon-size);-webkit-mask-repeat:no-repeat;-webkit-mask-position:center;mask-size:var(--icon-size) var(--icon-size);mask-repeat:no-repeat;mask-position:center;mask:url(/assets/magnifying-glass.svg);-webkit-mask:url(/assets/magnifying-glass.svg)}.rfd-search .icon-question-mark{width:var(--icon-size);height:var(--icon-size);-webkit-mask-size:var(--icon-size) var(--icon-size);-webkit-mask-repeat:no-repeat;-webkit-mask-position:center;mask-size:var(--icon-size) var(--icon-size);mask-repeat:no-repeat;mask-position:center;mask:url(/assets/question-mark.svg);-webkit-mask:url(/assets/question-mark.svg)}.rfd-search .icon-external-link{width:var(--icon-size);height:var(--icon-size);-webkit-mask-size:var(--icon-size) var(--icon-size);-webkit-mask-repeat:no-repeat;-webkit-mask-position:center;mask-size:var(--icon-size) var(--icon-size);mask-repeat:no-repeat;mask-position:center;mask:url(/assets/external-link.svg);-webkit-mask:url(/assets/external-link.svg)}.rfd-search .icon-circle-times{width:var(--icon-size);height:var(--icon-size);-webkit-mask-size:var(--icon-size) var(--icon-size);-webkit-mask-repeat:no-repeat;-webkit-mask-position:center;mask-size:var(--icon-size) var(--icon-size);mask-repeat:no-repeat;mask-position:center;mask:url(/assets/circle-times.svg);-webkit-mask:url(/assets/circle-times.svg)}.rfd-search .result-entry-container{border-radius:0;line-height:1}.rfd-search #search-results-widget .result-entry-container{border-bottom:solid var(--background-color-page-semi) 1px}.rfd-search route-result .result-text-area,.rfd-search logbook-result .result-text-area{max-width:100%;padding-left:40px}.rfd-search .ascent-style-indicator{margin-left:-15px;margin-right:4px}.rfd-search .mouse-over{color:#5f9ea0;cursor:pointer}.rfd-search .mouse-over:focus{color:var(--flash-color)}.rfd-search .fade-in{-webkit-animation:fadein var(--gray-view-opacity-animation-duration) linear forwards;animation:fadein var(--gray-view-opacity-animation-duration) linear forwards}@-webkit-keyframes fadein{0%{opacity:0}to{opacity:1}}@-moz-keyframes fadein{0%{opacity:0}to{opacity:1}}@-o-keyframes fadein{0%{opacity:0}to{opacity:1}}@keyframes fadein{0%{opacity:0}to{opacity:1}}.rfd-search .fade-out{-webkit-animation:fadeout var(--gray-view-opacity-animation-duration) linear forwards;animation:fadeout var(--gray-view-opacity-animation-duration) linear forwards}@-webkit-keyframes fadeout{0%{opacity:1}to{opacity:0}}@-moz-keyframes fadeout{0%{opacity:1}to{opacity:0}}@-o-keyframes fadeout{0%{opacity:1}to{opacity:0}}@keyframes fadeout{0%{opacity:1}to{opacity:0}}.loader-stopped{position:relative;background:var(--background-color-2);overflow:hidden}.loader-spinning{position:relative;height:2px;background:transparent;overflow:hidden;animation:loader-rainbow 1.5s infinite linear}.loader-spinning:after{display:block;content:" ";position:absolute;height:100%;background:hotpink;left:0;transform:translate3d(-150%,0,0);animation:loader-stripe 1.5s infinite linear}@keyframes loader-stripe{0%{transform:translate3d(-100%,0,0)}to{transform:translate3d(100%,0,0)}}@keyframes loader-rainbow{0%{background:var(--background-color-2)}50%{background:hotpink}to{background:var(--background-color-2)}}@media only screen and (min-width: 768px){:root{--icon-size: 2rem}.rfd-search{--page-control-size: 18pt;--radius: 4pt;--radius-search-results: 4pt;--border-width: 1pt;--font-size: .9rem;--page-control-font-size: var(--font-size-3);--font-size-2: calc(var(--font-size) * .9);--font-size-3: calc(var(--font-size-2) * .9);--font-size-4: calc(var(--font-size-3) * .9);--result-icon-size: 1.5rem}.rfd-search logbook-indicator{right:-5px}.rfd-search wishlist-indicator{right:0}.rfd-search #name-dash{display:inline-block}.rfd-search #star-count-and-route-grade{display:flex;flex-direction:row-reverse;translate:0 1.5px}.rfd-search #star-count-and-route-grade *{margin-right:.2rem}.rfd-search #search-icon{background-color:var(--subtitle-color)}.rfd-search input{padding-top:4pt;padding-bottom:4pt}.rfd-search #focus-searchbar,.rfd-search .keycode{display:unset}.rfd-search #searchbar-help-text{padding:calc(var(--base-padding) * var(--big-screen-multiplier) * 2)}.rfd-search #search-results-widget{margin-top:16pt;border:solid var(--background-color-2) var(--border-width);margin-right:50%;margin-left:50%;transform:translate(-50%);min-width:700px;box-shadow:0 0 10px #0101011a}.rfd-search #placeholder-short-display{margin-left:0;position:absolute;white-space:nowrap;transform:translate(4px,15px)}.rfd-search #searchbar-short-display-container{transform:translateY(-26%)}.rfd-search .page-control{width:400pt;margin-right:50%;margin-left:50%;transform:translate(-50%);min-width:700px}.rfd-search #filter-bar-container input{padding-top:calc(var(--padding) / 2);padding-bottom:calc(var(--padding) / 2)}.rfd-search #search-container{max-width:500pt;left:50%;transform:translate(-50%)}.rfd-search #search-query-description,.rfd-search .search-results-search-query-description{padding:calc(var(--base-padding) * var(--big-screen-multiplier) * 2)}.rfd-search #searchbar-query-suggestion-flex,.rfd-search #search-query-description,.rfd-search .search-results-search-query-description{font-size:calc(var(--font-size-2) * .9)}.rfd-search .result-entry-container{line-height:1}.rfd-search .ascent-details,.rfd-search .ascent-notes{font-size:var(--font-size-3)}.rfd-search .result-entry{padding-top:calc(var(--padding) / 1.85);padding-bottom:calc(var(--padding) / 1.85);align-items:center}.rfd-search .result-crag-name{padding-bottom:2pt}.rfd-search .selected .result-entry{border-radius:calc(var(--radius) * .7)}.rfd-search .icon{margin-right:unset}.rfd-search .result-entry-end{padding-left:var(--padding);flex-direction:column;align-items:baseline;flex-grow:1}.rfd-search .footer-content{padding:4px 10px 4px 4px}.rfd-search .nightmode #search-results-widget{box-shadow:0 0 10px #01010133}.rfd-search .result-icon-area{margin-top:unset}.rfd-search .result-text-area{flex-direction:row;justify-content:space-between}.rfd-search .result-entry-start{align-self:center;margin-bottom:unset}.rfd-search .result-entry-end{flex-direction:column;align-items:flex-end}.rfd-search .ascent-style-indicator{margin-left:-13px}}select{-webkit-appearance:none;-moz-appearance:none;appearance:none;text-overflow:""}
`;function A(e,t){const r=e.closest(t);if(!r){const s=e.getRootNode();return s instanceof ShadowRoot?s.host.closest(t):null}return r}c(A,"closestShadowPiercing");const U=c((e,t,r)=>(e.getAttribute(t)||"").trim().split(/\s+/g).map(s=>r(s)),"parseElementTags"),q=new Map,Je=new MutationObserver(e=>{for(const t of e)if(t.type==="attributes"){const r=t.attributeName,s=t.target;if(s instanceof Element&&q.has(r)){const[a,o]=q.get(r);for(const[i,...n]of U(s,r,a)){const d=A(s,i);d&&o(s,d,r,...n)}}}else if(t.addedNodes.length)for(const r of t.addedNodes)r instanceof Element&&F(r)}),se=c((e,t,r)=>{if(q.has(e))throw new Error("duplicate tag");q.set(e,[t,r])},"registerTag"),F=c(e=>{for(const[t,[r,s]]of q){for(const a of e.querySelectorAll(`[${t}]`))for(const[o,...i]of U(a,t,r)){const n=A(a,o);n&&s(a,n,t,...i)}if(e instanceof Element&&e.hasAttribute(t))for(const[a,...o]of U(e,t,r)){const i=A(e,a);i&&s(e,i,t,...o)}}Je.observe(e instanceof Element?e.ownerDocument:e,{childList:!0,subtree:!0,attributeFilter:Array.from(q.keys())})},"observeElementForTags"),Ze=c((e,t)=>{for(;e;){const r=Object.getOwnPropertyDescriptor(e,t);if(r)return r;e=Object.getPrototypeOf(e)}},"getPropertyDescriptor"),Ce=c(e=>{if(e){if(typeof e.value=="function")return"method";if(typeof e.get=="function")return"getter";if(typeof e.set=="function")return"setter"}return"field"},"getType");function ae(e,t){const r=new WeakMap,s=c(i=>{if(!r.has(i)){const n=Object.getPrototypeOf(i);r.set(i,new Set(n?s(n)||[]:[]))}return r.get(i)},"get"),a=c((i,n,d)=>{s(i).has(n)||(e({name:n,kind:Ce(d)}),s(i).add(n))},"marker");a.static=Symbol();const o=c(i=>{const n=Object.getPrototypeOf(i);for(const d of n.constructor[a.static]||[])a(n,d,Object.getOwnPropertyDescriptor(n,d));return new Set(s(n))},"getMarks");return[a,o,i=>{for(const n of o(i)){const d=Ze(i,n)||{value:void 0,configurable:!0,writable:!0,enumerable:!0},P=t(i,{name:n,kind:Ce(d),access:d})||d;Object.defineProperty(i,n,Object.assign({configurable:!0,enumerable:!0},P))}}]}c(ae,"createMark");const $e=new WeakMap,Q=c(e=>t=>{const r=$e.get(t);if(r?.has(e))return t;const s=e(t);Object.defineProperty(s,"name",{value:t.name});const a=new Set(r);return a.add(e),$e.set(s,a),s},"createAbility"),D=Symbol(),Pe=Symbol(),oe=new WeakMap,ie=new WeakMap,ne=new WeakSet,ce=Q(e=>class extends e{constructor(...t){super(...t);const r=this.shadowRoot;if(r&&r!==oe.get(this)&&this[D](r),!ne.has(this))try{this.attachInternals()}catch{}}connectedCallback(){this.setAttribute("data-catalyst",""),super.connectedCallback?.()}attachShadow(...t){const r=super.attachShadow(...t);return this[D](r),r}[D](t){oe.set(this,t)}attachInternals(){if(ie.has(this)&&!ne.has(this))return ne.add(this),ie.get(this);const t=super.attachInternals();return this[Pe](t),ie.set(this,t),t}[Pe](t){const r=t.shadowRoot;r&&r!==oe.get(this)&&this[D](r)}}),O=c(e=>String(typeof e=="symbol"?e.description:e).replace(/([A-Z]($|[a-z]))/g,"-$1").replace(/--/g,"-").replace(/^-|-$/,"").toLowerCase(),"dasherize"),Ge=c((e,t="property")=>{const r=O(e);if(!r.includes("-"))throw new DOMException(`${t}: ${String(e)} is not a valid ${t} name`,"SyntaxError");return r},"mustDasherize"),Xe=Symbol(),et=Symbol(),[l,tt,rt]=ae(({name:e,kind:t})=>{if(t==="getter")throw new Error(`@target cannot decorate get ${String(e)}`)},(e,{name:t,access:r})=>{const s=[`[data-target~="${e.tagName.toLowerCase()}.${O(t)}"]`,`[data-target~="${e.tagName.toLowerCase()}.${String(t)}"]`],a=Re(e,s.join(", "),!1);return{get:a,set:()=>{r?.set&&r.set.call(e,a())}}}),[W,st,at]=ae(({name:e,kind:t})=>{if(t==="getter")throw new Error(`@target cannot decorate get ${String(e)}`)},(e,{name:t,access:r})=>{const s=[`[data-targets~="${e.tagName.toLowerCase()}.${O(t)}"]`,`[data-targets~="${e.tagName.toLowerCase()}.${String(t)}"]`],a=Re(e,s.join(", "),!0);return{get:a,set:()=>{r?.set&&r.set.call(e,a())}}});function De(e,t,r,s){const a=r==="data-targets"?st:tt;t instanceof ShadowRoot&&(t=Ee.get(t)),t&&a(t)?.has(s)&&(t[s]={})}c(De,"setTarget"),se("data-target",e=>e.split("."),De),se("data-targets",e=>e.split("."),De);const Oe=new WeakMap,Ee=new WeakMap,Re=c((e,t,r)=>()=>{const s=[],a=Oe.get(e);if(a){for(const o of a.querySelectorAll(t))if(!o.closest(e.tagName)&&(s.push(o),!r))break}if(r||!s.length){for(const o of e.querySelectorAll(t))if(o.closest(e.tagName)===e&&(s.push(o),!r))break}return r?s:s[0]},"findTarget"),ot=Q(e=>class extends ce(e){constructor(){super(),F(this),rt(this),at(this)}[Xe](){}[et](){}[D](t){super[D]?.(t),Oe.set(this,t),Ee.set(t,this),F(t)}}),qe=Symbol(),Ne=c(e=>e,"Identity");let le=!1;const K=new WeakMap,it=c(e=>{for(const t of e)if(t.type==="attributes"){const r=t.attributeName,s=t.target,a=K.get(s)?.get(r);a&&(le=!0,s[a]=s.getAttribute(r),le=!1)}},"handleMutations"),nt=new MutationObserver(it),[g,ct,lt]=ae(({name:e})=>Ge(e,"@attr"),(e,{name:t,kind:r,access:s})=>{let a=Ne,o;s.get?o=s.get.call(e):"value"in s&&r!=="method"&&(o=s.value);let i=o;const n=O(t),d=(r==="method"?s.value:s.set)||Ne,P=s.get||(()=>i);K.get(e)||K.set(e,new Map),K.get(e).set(n,t),typeof i=="number"?a=Number:typeof i=="boolean"?a=Boolean:typeof i=="string"&&(a=String);const R=new Map,xe=c(async x=>{if(R.set(t,x),R.size>1)return;await Promise.resolve();const re=new Map(R);R.clear(),e[qe](re)},"requestAttrChanged");return{get(){const x=e.hasAttribute(n);return x?a===Boolean?x:a(e.getAttribute(n)):a(P.call(e))},set(x){const re=x===null;re&&(x=o);const Er=Object.is(i,x);i=x,d.call(e,i),!(le||Er||re)&&xe(x)}}}),dt=Q(e=>class extends ce(e){constructor(){super(),lt(this),nt.observe(this,{attributeFilter:Array.from(ct(this)).map(O)})}[qe](t){if(!!this.isConnected)for(const[r,s]of t)typeof s=="boolean"?this.toggleAttribute(O(r),s):this.setAttribute(O(r),String(s))}}),Te=c(e=>{const t=e.lastIndexOf(":"),r=Math.max(0,e.lastIndexOf("#"))||e.length;return[e.slice(t+1,r),e.slice(0,t),e.slice(r+1)||"handleEvent"]},"parseActionAttribute");se("data-action",Te,(e,t,r,s)=>{e.addEventListener(s,ht)});const de=new WeakSet;function ht(e){const t=e.currentTarget;for(const[r,s,a]of U(t,"data-action",Te))if(e.type===s){const o=t.closest(r);de.has(o)&&typeof o[a]=="function"&&o[a](e);const i=t.getRootNode();if(i instanceof ShadowRoot){const n=i.host;n.matches(r)&&de.has(n)&&typeof n[a]=="function"&&n[a](e)}}}c(ht,"handleEvent");const ut=Q(e=>class extends ce(e){constructor(){super(),de.add(this),F(this)}[D](t){super[D]?.(t),F(t)}});function pt(e){const t=O(e.name).replace(/-(element|controller|component)$/,"");try{window.customElements.define(t,e),window[e.name]=customElements.get(t)}catch(r){if(!(r instanceof DOMException&&r.name==="NotSupportedError"))throw r}return e}c(pt,"register");function m(e){return pt(ut(dt(ot(e))))}c(m,"controller"),new Promise(e=>{document.readyState!=="loading"?e():document.addEventListener("readystatechange",()=>e(),{once:!0})}),new Promise(e=>{const t=new AbortController;t.signal.addEventListener("abort",()=>e());const r={once:!0,passive:!0,signal:t.signal},s=c(()=>t.abort(),"handler");document.addEventListener("mousedown",s,r),document.addEventListener("touchstart",s,r),document.addEventListener("keydown",s,r),document.addEventListener("pointerdown",s,r)});const gt={sanitize:e=>e},f=c((e,...t)=>t.length===0?e[0]:String.raw({raw:e},...t),"html$1"),h=c(e=>e&&gt.sanitize(e),"escape");var ft=Object.defineProperty,mt=Object.getOwnPropertyDescriptor,bt=c((e,t,r,s)=>{for(var a=s>1?void 0:s?mt(t,r):t,o=e.length-1,i;o>=0;o--)(i=e[o])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&ft(t,r,a),a},"__decorateClass$i");let he=c(class extends HTMLElement{get topOffset(){let e=0,t=this;for(;e+=t.offsetTop,t.offsetParent!==null;)t=t.offsetParent;return e}static get elementName(){return this.name.replace(/(.)([A-Z]+)/g,e=>e[0]+"-"+e[1].toLowerCase()).toLowerCase().replace(/-element$/g,"")}get elementName(){return this.constructor.elementName}_template;get template(){if(!this._template)throw new Error("You need to override me me");return this._template}set template(e){this._template=e}connectedCallback(){this.innerHTML||=this.template(this)}htmlForSlot(e){return""}},"BaseCon");he=bt([m],he);const L=he;var yt=Object.defineProperty,vt=Object.getOwnPropertyDescriptor,ue=c((e,t,r,s)=>{for(var a=s>1?void 0:s?vt(t,r):t,o=e.length-1,i;o>=0;o--)(i=e[o])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&yt(t,r,a),a},"__decorateClass$h");let V=c(class extends L{span;set pageNumber(e){this&&(this.innerHTML=h(""+e))}get template(){return e=>f``}connectedCallback(){super.connectedCallback()}},"PageButtonElement");ue([l],V.prototype,"span",2),ue([g],V.prototype,"pageNumber",1),V=ue([m],V);const _t=c(e=>{const t=e.elementName;return f`
<div class='page-control'>
    <span data-target='${t}.previous' id='page-control-previous'>←</span>
    <span data-target='${t}.next' id='page-control-next'>→</span>
</div>
`},"pageControlTemplate");var wt=Object.defineProperty,kt=Object.getOwnPropertyDescriptor,Y=c((e,t,r,s)=>{for(var a=s>1?void 0:s?kt(t,r):t,o=e.length-1,i;o>=0;o--)(i=e[o])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&wt(t,r,a),a},"__decorateClass$g");let I=c(class extends L{previous;pages;next;maxPageButtons=7;onPageControlClicked=e=>{};_pageControlClicked(){this.onPageControlClicked(this)}get template(){return _t}connectedCallback(){super.connectedCallback(),this.next.onclick=e=>{this.next.classList.contains("disabled")||(this.currentPage++,this._pageControlClicked())},this.previous.onclick=e=>{this.previous.classList.contains("disabled")||(this.currentPage--,this._pageControlClicked())}}_pageCount=1;get pageCount(){return this._pageCount}set pageCount(e){e=Number(e),!isNaN(e)&&(this._pageCount=e,this.createPages(e,this.currentPage))}_currentPage=0;get currentPage(){return this._currentPage}set currentPage(e){if(!(e<0)){e=Math.min(e,this.pageCount),this._currentPage=e,this.createPages(this.pageCount,e),this.previous.classList.remove("disabled"),this.next.classList.remove("disabled"),this.pages.forEach(t=>t.classList.remove("page-control-current")),e+1===this.pageCount&&this.next.classList.add("disabled"),e===0&&this.previous.classList.add("disabled");for(const t of this.pages)t.pageNumber===e+1&&t.classList.add("page-control-current")}}createPages(e,t){this.removeAllPages();const r=this.visiblePageNumbers(t);for(const s of r){const a=document.createElement("page-button");a.setAttribute("data-targets","page-control.pages"),a.addEventListener("click",this.pageClicked.bind(this)),a.classList.add("page-control-page"),this.next.parentNode.insertBefore(a,this.next),a.pageNumber=s}}pageClicked(e){this.currentPage!=e.target.pageNumber-1&&(this.currentPage=e.target.pageNumber-1,this._pageControlClicked())}removeAllPages(){this.pages.forEach(e=>e.remove())}visiblePageNumbers(e){e=Number(e);const t=Math.floor(this.maxPageButtons/2);let r=Math.max(e-t,0),s=Math.min(Math.max(e+t,this.maxPageButtons+1),this.pageCount+1);return s-r<this.maxPageButtons&&(r=s-this.maxPageButtons),(isNaN(r)||isNaN(s))&&(s=0,r=0),e=0,r=Math.max(1,r),[...Array(s+1).keys()].slice(r,s)}},"PageControlElement");Y([l],I.prototype,"previous",2),Y([W],I.prototype,"pages",2),Y([l],I.prototype,"next",2),I=Y([m],I);function N(){const e=window.location.origin;return e.match(/localhost|local\./gi)?"http://127.0.0.1:3002":e.match(/dev\.|ryecroft.github.io/gi)?"https://dev.api.rockfax.app":"https://api.rockfax.app"}c(N,"apiOrigin");const ze=c(()=>`${N()}/v1/rockfax/search/routedb_search_ukc`,"generateApiUrl$4"),St=["","*","**","***"];let Ae=["stanage hvs&#8288;-&#8288;e2 ***","damp scary crack","nevis winter ***","pat littlejohn devon e4","fontainebleau f7a |soft|",'"lake district" trad vd-hvs ***',"kalymnos sport |soft|","granite sport scotland **","peak e4&#8288;-&#8288;e5 |overgraded| **","wide crack peak grit","e5&#8288;-&#8288;e7 1970&#8288;-&#8288;1975","el&nbsp;cap 5.8&#8288;-&#8288;5.10","e4&#8288;-&#8288;e6 fawcett yorkshire *** 1980&#8288;-&#8288;1994"];const xt=c(e=>{const t=e.elementName;return f`
        <div class='rfd-search'>
            <!-- <div data-target='${t}.search_query_description_top' class='search-results-search-query-description fixed-top w-100 d-md-none' style='font-size:0.7em;opacity:0;transition:opacity 0.2s ease-out;'></div>-->
            <div data-target="${e.elementName}.search_results_header_container" id='search-results-header-container'>
                <div class='ukc-search-results-header'>
                    <h1 data-target="${e.elementName}.search_results_title" class='mb-4 mt-4 pt-3' style='font-size: 1.1rem;color:var(--title-color)'></h1>
                    <div class="ukc-search-results-controls">
                        <select data-target="${e.elementName}.sort_order" class="ukc-search-results-sort-order">
                            ${e.htmlForSlot("ukc-search-results-sort-order-options")}
                        </select>
                        <button class="fa-button" data-target="${e.elementName}.sort_button" data-action="click:${e.elementName}#toggleSortOrder"><i class="fas fa-arrow-down" data-target="${e.elementName}.sort_arrow"></i></button>
                    </div>
                </div>
                <div id='filter-bar-container'>
                    <span id='filter-icon' class='icon icon-magnifying-glass' alt='icon'></span>
                    <input data-target='${t}.input' id='filter-bar'  spellcheck='false' autocorrect='off' autocomplete='off' autocapitalize='off' type='search' placeholder='Filter results...' />
                    <span data-target='${t}.delete_text_button' id='filter-delete-text-button' tabindex='-1' class='icon icon-circle-times hidden' alt='icon'></span>
                </div>
                <div data-target='${t}.progressBar' id='search-results-progress' class='loader-stopped'></div>
                <div data-target='${t}.search_query_description' class='search-results-search-query-description' style='border-bottom: solid var(--background-color-page-semi) 1px;'></div>
            </div>
            <div id='search-results-widget'>
                <!--<div data-target='${t}.search_results_header_spacer'></div>-->
                <ul data-target='${t}.search_results_container' id='search-results-container-search-results'></ul>
            </div>
            <page-control data-target='${t}.page_control'></page-control>
        </div>
    `},"searchResultsTemplate");function j(){return!window.matchMedia("only screen and (min-width: 768px)").matches}c(j,"isMobile");function Lt(e){j()&&e()}c(Lt,"performIfMobile");function Fe(e,t){const r=document.createElement("hr");r.classList.add("divider-no-height-set");const s=e.search_results_container.children[t];s&&e.search_results_container.insertBefore(r,s)}c(Fe,"appendDivider");function T({target:e,route:t,tagName:r}){r||="search-result";const s=document.createElement(r);s.classList.remove("hidden"),s.classList.add("route-entry"),s.itemName=h(t.item_name),s.cragName=h(t.crag_name);let a=h(t.tech_grade?" "+t.tech_grade:"");return t.tech_grade&&t.tech_grade.match(/^S\d$/)&&(a=f`<span style="color:#93AFEC">${a}</span>`),s.routeGrade=`${t.route_grade}${a}`,s.starCount=t.star_count,s.cragName=h(t.crag_name),s.countyName=h(t.county_name),s.countryName=h(t.country_name),s.routeIdUkc=t.id_ukc,s.colorId=t.grade_color_id,s.slugFull=t.slug_full,e.search_results_container.appendChild(s),s.resultType="route",s}c(T,"appendRoute");function Ie({target:e,crag:t}){const r=document.createElement("search-result");r.classList.remove("hidden"),r.classList.add("crag-entry"),r.itemName=h(t.item_name);const s=t.route_type_names_string.replace(/\|\|/g,"/").replace(/\|/g,"");return r.routeGrade=s,r.cragName=t.rock_type_names_string.replace("UNKNOWN","Unknown"),r.countyName=h(t.county_name),r.countryName=h(t.country_name),r.slugFull=t.slug,r.logStatus="unclimbed",r.wishlistStatus=!1,e.search_results_container.appendChild(r),r.resultType="crag",r}c(Ie,"appendCrag");function J(e){const t=document.createElement("search-result");t.classList.remove("hidden"),t.classList.add("no-results-entry"),t.itemName="No matching results ='[",e.search_results_container.appendChild(t),t.resultType="no-result"}c(J,"appendNoResults");function je(e){if(e.stopPropagation(),e.key=="Escape"){this.resignFocus();return}if(this.search_results_container.children.length!=0)switch(e.key){case"ArrowDown":e.preventDefault(),this.onArrowDownKey();break;case"ArrowUp":e.preventDefault(),this.onArrowUpKey();break;case"Enter":e.preventDefault(),this.onEnterKey(e);break}}c(je,"onKeyPressedEvent");function Be(){for(let e=0;e<this.search_results_container.children.length;e++)if(this.search_results_container.children[e].classList.contains("selected")){if(e<this.search_results_container.children.length-1){this.search_results_container.children[e].classList.remove("selected");let t=this.search_results_container.children[e+1];t.tagName==="HR"&&(t=this.search_results_container.children[e+2]),t.classList.add("selected"),this.isElementVisible(t)===!1&&t.scrollIntoView({behavior:"smooth",block:"center"})}return}this.search_results_container.children[0].classList.add("selected")}c(Be,"onArrowDownKey");function Me(){for(let e=0;e<this.search_results_container.children.length;e++)if(this.search_results_container.children[e].classList.contains("selected")){if(this.search_results_container.children[e].classList.remove("selected"),e>0){let t=this.search_results_container.children[e-1];t.tagName==="HR"&&(t=this.search_results_container.children[e-2]),t.classList.add("selected"),this.isElementVisible(t)===!1&&t.scrollIntoView({behavior:"smooth",block:"center"})}else return;return}}c(Me,"onArrowUpKey");function Ct(e){if(e.getModifierState("Shift")){this.submitSearch();return}for(let t=0;t<this.search_results_container.children.length;t++)if(this.search_results_container.children[t].classList.contains("selected")){this.search_results_container.children[t].href.click();return}this.submitSearch()}c(Ct,"onEnterKey");class C{constructor(t){if(this.cookie=t,!t)throw new Error("no cookie!");const r=t.split("; ");for(const s of r){const[a,o]=s.split("=");this._lookup[a]=o}this._ukcSid=new He(this)}_lookup={};_ukcSid;static default(){return new C(document.cookie)}get userIdUkc(){return this._ukcSid.ukcId||void 0}get ukcCookiesSid(){return this._ukcSid.cookieSid}get(t){return this._lookup[t]}}c(C,"Cookies");class He{constructor(t){this.cookies=t;const r=t.get("ukcsid")?.split("#");!r||(this.cookieSid=r.shift(),this.ukcId=Number(r.shift()))}cookieSid;ukcId=0}c(He,"UkcSid");var $t=Object.defineProperty,Pt=Object.getOwnPropertyDescriptor,k=c((e,t,r,s)=>{for(var a=s>1?void 0:s?Pt(t,r):t,o=e.length-1,i;o>=0;o--)(i=e[o])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&$t(t,r,a),a},"__decorateClass$f");let w=c(class extends L{get apiUrl(){return ze()}searchResultsIdentifier="search-results";lastSearch;searchDelay=300;search_results_container;searchBar;input;progressBar;delete_text_button;search_query_description;search_results_header_container;search_results_title;page_control;sort_order;sort_arrow;sort_button;currentPage=1;get query(){return this.input.value}set query(e){document.activeElement!==this.input&&this.input.focus(),this.input&&(this.input.value=e||""),this.input.dispatchEvent(new Event("input",{bubbles:!0}))}searchBarPlaceholderString="Perform a new search...";timeout;searchId=0;preventLayoutShift=!1;apiData;baseData;get template(){return xt}get sortOrderKey(){return"search_results_sort_order"}get sortDirectionKey(){return`${this.sortOrderKey}_direction`}get defaultSortOrder(){return"score"}get savedSortOrder(){return localStorage.getItem(this.sortOrderKey)||this.defaultSortOrder}get savedSortDirection(){const e=localStorage.getItem(this.sortDirectionKey);return this.convertStringToSortDirection(e)}get urlQuery(){return new URLSearchParams(window.location.search).get("query")}get urlSortDirection(){let e=new URLSearchParams(window.location.search);return this.convertStringToSortDirection(e.get("direction"))}convertStringToSortDirection(e){switch(e){case"asc":return"asc";case"desc":return"desc";default:return}}set urlSortDirection(e){let t=new URLSearchParams(window.location.search);t.set("direction",e),window.history.replaceState({},"","?"+t.toString())}get urlFilter(){return new URLSearchParams(window.location.search).get("filter")}set urlFilter(e){let t=new URLSearchParams(window.location.search);t.set("filter",e),window.history.replaceState({},"","?"+t.toString())}get urlPage(){const t=new URLSearchParams(window.location.search).get("page")||"1";return Number(t)-1}set urlPage(e){e||=0,e+=1;let t=new URLSearchParams(window.location.search);t.set("page",e.toString()),window.history.replaceState({},"","?"+t.toString())}get urlSortOrder(){return new URLSearchParams(window.location.search).get("sort")}set urlSortOrder(e){let t=new URLSearchParams(window.location.search);t.set("sort",e),window.history.replaceState({},"","?"+t.toString())}get searchbarTag(){return"ukc-searchbar"}responseMessage="";connectedCallback(){window.location.origin.match(/local/)&&(document.cookie="ukcsid=ac37cdfcb90a91711a6fbd3dac9137d9#45296#Stephen%20Horne%20-%20Rockfax#0"),super.connectedCallback(),this.sort_button.style.display="none",this.sort_order.style.display="none",this.sort_order.value=this.urlSortOrder||this.savedSortOrder,this.sortDirectionFromButton=this.urlSortDirection||this.savedSortDirection,this.sort_order.addEventListener("change",r=>{this.sortOrderChanged(r)}),j()&&(this.searchDelay=500),this.input.value=this.urlFilter,Object.defineProperty(this,"onKeyPressedEvent",{value:je}),Object.defineProperty(this,"onEnterKey",{value:this.onEnterKey}),Object.defineProperty(this,"onArrowUpKey",{value:Me}),Object.defineProperty(this,"onArrowDownKey",{value:Be}),document.addEventListener("DOMContentLoaded",()=>{this.searchBar=document.getElementsByTagName(this.searchbarTag)[0],this.searchBar.searchWidget.style.opacity="0",this.searchBar.input.addEventListener("focus",()=>{this.searchBar.searchWidget.style.opacity="1"}),this.searchBar.grayView.addEventListener("click",()=>{this.searchBar.searchWidget.style.opacity="0"}),this.searchBar.input.placeholder=this.searchBarPlaceholderString,this.searchBar.input.value=this.urlQuery||"",this.searchBar.input.value&&this.searchBar.fetchResults(),this.searchBar.delete_text_button.classList.remove("hidden"),this.searchBar.submitSearchHandler=r=>{this.startProgressBar(),this.searchBar.resignFocus(),window.history.pushState({},"",r),setTimeout(()=>{this._init()},300)}}),document.addEventListener("scroll",async r=>{this.search_results_container.getBoundingClientRect().top,this.search_query_description.getBoundingClientRect().height});let e=0;document.addEventListener("scroll",async r=>{if(this.preventLayoutShift)return;const s=this.search_results_container.getBoundingClientRect().top;let a=s-e;if(e=s,a>30&&(this.search_results_header_container.style.top="-60px"),a>0||a>-20)return;const o=this.search_results_header_container;o.style.zIndex="1";const i=this.search_query_description.getBoundingClientRect().top-this.search_results_header_container.getBoundingClientRect().top;o.style.top=-i+"px"}),this.search_query_description.addEventListener("click",r=>{this.search_results_header_container.style.top="-60px"}),this.search_results_header_container.style.position="sticky",this.search_results_header_container.style.transition="all 0.3s ease-out",this.search_results_header_container.style.top="0",this.input.addEventListener("focus",()=>this.onInputFocus()),this.input.addEventListener("input",()=>this.onInputUpdated()),this.delete_text_button.addEventListener("mousedown",r=>r.preventDefault()),this.delete_text_button.addEventListener("click",r=>{this.query="",r.stopPropagation()}),this.input.addEventListener("keydown",r=>this.onKeyPressedEvent(r)),this._init(),this.page_control.onPageControlClicked=async r=>{this.startProgressBar();const s=await this._fetchResults(this.fullQuery,r.currentPage);this.urlPage=r.currentPage,this.stopProgressBar(),this.buildResults(s)};const t=this.input;document.ontouchstart=function(r){document.activeElement===t&&t.blur()},this.input.focus()}resignFocus(){this.input.blur()}sortOrderChanged(e){this.baseData=void 0,this.lastSearch=void 0,this.onInputUpdated(),this.urlSortOrder=this.sort_order.value,localStorage.setItem(this.sortOrderKey,this.sort_order.value)}onInputFocus(){}getElementById(e){let t=document.getElementById(e);if(!t)throw new Error(`failed to find element with id ${e}`);return t}get allowEmptyQuery(){return!1}async _init(){this.startProgressBar();const e=localStorage.getItem(this.searchResultsIdentifier),t=!this.urlFilter;if(e)try{this.buildResults(JSON.parse(e)),this.stopProgressBar(),localStorage.setItem(this.searchResultsIdentifier,"");return}catch{}let r=this.queryToUseDuringInit();if(r!==null||this.allowEmptyQuery){let s=await this._fetchResults(r,this.urlPage);this.buildResults(s),t&&(this.baseData=s),this.stopProgressBar()}}queryToUseDuringInit(){return this.fullQuery||""}async _fetchResults(e,t){return await this.fetchResultsForPage(e,t)}response;async fetchResultsForPage(e,t){try{e=e?.trim()||"";const r=await fetch(this.apiUrl,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(this.bodyForRequest(e,t))});return this.response=r.clone(),await r.json()}catch(r){console.error("failed to fetch results"),console.error(r)}}bodyForRequest(e,t){return{cookie:C.default().cookie,search_query:e,page_size:100,page:t,sort_by:this.sort_order.value,direction:this.sortDirectionFromButton}}get sortDirectionFromButton(){return this.sort_arrow.style.rotate==="180deg"?"asc":"desc"}set sortDirectionFromButton(e){const t=this.sort_arrow,r=e==="asc";t.style.rotate=r?"180deg":"0deg"}toggleSortOrder(){this.sort_arrow.style.rotate=this.sortDirectionFromButton==="desc"?"180deg":"0deg",this.baseData=void 0,this.lastSearch=void 0,this.onInputUpdated(),localStorage.setItem(this.sortDirectionKey,this.sortDirectionFromButton)}htmlForSlot(e){return e==="ukc-search-results-sort-order-options"?f`
        <option value="score"      >Order by search score</option>
        <option value="crag_name" >Order by crag name</option>
        <option value="grade"     >Order by route grade</option>
        <!--<option value="voted_grade">Order by voted grade</option>-->
      `:""}clearResultsDropdown(){this.search_results_container.innerHTML=""}queue=[];buildResults(e){if(console.log(e),this.queue=[],this.clearResultsDropdown(),this.apiData=e,this.page_control.pageCount=e.meta?.total_pages,this.page_control.currentPage=e.meta?.page,e.objects?.length===0&&J(this),this.search_query_description)if(e.meta?.parsed_query){const s=e.meta?.total_matches;this.search_query_description.innerHTML=e.meta.parsed_query.queryDescription+` (${s}&nbsp;match${s===1?"":"es"})`}else this.search_query_description.innerHTML="";let t=0,r=0;e.objects?.forEach((s,a)=>{switch(s.type){case"route_ukc":{t++,this.willAppendRoute(s,this,a,t),this.queue.push(()=>{this.appendRoute(this,s)});break}case"crag_ukc":{r++,this.queue.push(()=>{this.appendCrag(this,s)});break}}t==1&&r&&this.queue.push(()=>{Fe(this,a)})}),this.processQueue()}willAppendRoute(e,t,r,s){}processQueue(){if(this.queue.length){this.preventLayoutShift=!0;let e=0;const t=this.search_results_container.children.length>4?1:10;for(;e<t&&this.queue.length;)this.queue.shift()(),e++;setTimeout(()=>{this.processQueue()},0)}else this.preventLayoutShift=!1}appendCrag(e,t){return Ie({target:e,crag:t})}appendRoute(e,t,r){return T({target:e,route:t,tagName:r})}submitSearch(){}startProgressBar(){this.progressBar.classList.add("loader-spinning"),this.search_results_container.style.opacity="0.4"}stopProgressBar(){this.progressBar.classList.remove("loader-spinning"),this.search_results_container.style.opacity="1"}showHelp(){alert("help text")}onInputUpdated(e=!1){const t=this.input.value.trim();if(t?this.delete_text_button.classList.remove("hidden"):this.delete_text_button.classList.add("hidden"),clearTimeout(this.timeout),!e&&!t&&this.baseData){console.log(this.baseData),this.lastSearch="",this.stopProgressBar(),this.buildResults(this.baseData),this.urlFilter=t;return}const r=this.sortDirectionFromButton;this.startProgressBar(),this.searchId++;const s=this.searchId;this.timeout=setTimeout(async()=>{const a=this.fullQueryWithoutUrlFilter;let o=await this._fetchResults(a,0);this.searchId>s||(this.stopProgressBar(),this.searchId=s,this.lastSearch=a,this.buildResults(o),this.urlFilter=t,this.urlSortDirection=r,this.urlPage=0)},this.searchDelay)}get fullQuery(){return((new URLSearchParams(window.location.search).get("query")||"")+" "+(this.input.value||this.urlFilter||"")).trim()}get fullQueryWithoutUrlFilter(){return((new URLSearchParams(window.location.search).get("query")||"")+" "+this.input.value).trim()}onKeyPressedEvent(e){}onArrowDownKey(){}onArrowUpKey(){}onEnterKey(e){this.input.blur()}isElementVisible(e){const t=e.getBoundingClientRect(),r=t.top;let a=t.bottom<(window.visualViewport?.height||0);return a=a&&r>0,a}},"SearchResults");k([l],w.prototype,"search_results_container",2),k([l],w.prototype,"input",2),k([l],w.prototype,"progressBar",2),k([l],w.prototype,"delete_text_button",2),k([l],w.prototype,"search_query_description",2),k([l],w.prototype,"search_results_header_container",2),k([l],w.prototype,"search_results_title",2),k([l],w.prototype,"page_control",2),k([l],w.prototype,"sort_order",2),k([l],w.prototype,"sort_arrow",2),k([l],w.prototype,"sort_button",2),w=k([m],w);const Dt=w,Ot=c(e=>{const t=e.elementName;return f`
        <div class='rfd-search'>
            <div data-target='${t}.grayView' id='gray-view' class='hidden'></div>
            <div id='search-container'>
                <input data-target='${t}.inputHidden' id='input-hidden' spellcheck='false' autocorrect='off' autocomplete='off' autocapitalize='off' type='search' placeholder='' />
                <div data-target='${t}.searchAbsolute' id='search-absolute'>
                    <div data-target='${t}.searchbarShortDisplayContainer' id='searchbar-short-display-container'>
                        <span id='search-icon-short-display' class='icon icon-magnifying-glass' alt='icon'></span>
                        <span id='placeholder-short-display'>Search all routes/crags...</span>
                    </div>
                    <div data-target='${t}.searchWidget' id='search-widget'>
                        <div data-target='${t}.searchbarInnerContainer' id='searchbar-inner-container'>
                            <span id='search-icon' class='icon icon-magnifying-glass' alt='icon'></span>
                            <input data-target='${t}.input' id='searchbar' spellcheck='false' autocorrect='off' autocomplete='off' autocapitalize='off' type='search' placeholder='Search all routes/crags...' data-results-url='/frontend/views/route_search/example.html' />
                            <span data-target='${t}.delete_text_button' id='delete-search-text-button' tabindex='-1' class='icon icon-circle-times hidden' alt='icon'></span>
                        </div>
                        <div>
                            <div data-target='${t}.progressBar' id='progess' class='loader-stopped hidden'></div>
                            <div data-target='${t}.search_query_description' id='search-query-description' class='hidden'></div>
                            <div data-target='${t}.querySuggestionContainer' id='searchbar-help-text-container' class='hidden'>
                                <div id='searchbar-query-suggestion-flex'>
                                    <div data-target='${t}.searchbarQuerySuggestion' id='searchbar-help-text'></div>
                                    <div data-target='${t}.helpButton' tabindex='-1' id='help-button' class='icon icon-question-mark' alt='icon'></div>
                                </div>
                            </div>
                        </div>
                        <div data-target='${t}.helpTextContainer' class='hidden'>
                        </div>
                        <ul data-target='${t}.search_results_container' id='search-results-container' class='hidden'>
                        </ul>
                        <div data-target='${t}.searchbarFooter' id='searchbar-footer' class='hidden'>
                            <div id='searchbar-footer-content'>
                                <div class='divider'></div>
                                <div class='footer-content'>
                                    <div style='align-items:center; display:flex; flex-direction:row-reverse; min-height:2rem'>
                                        <span data-target='${t}.returnKeyAction' class='mouse-over'>
                                            <span data-target='${t}.showAllResultsSpan' id='return-key-action' style='padding-right:4px;padding-left:8px;'>show all results</span>
                                            <span class='keycode'>⇧</span>
                                            <span class='keycode'>⏎</span>
                                        </span>
                                        <span id='focus-searchbar-group'>
                                            <span id='focus-searchbar' style='padding-right:2px;'>focus searchbar</span>
                                            <span class='keycode' style='font-weight:900;'>／</span>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `},"searchbarTemplate");var Et=Object.defineProperty,Rt=Object.getOwnPropertyDescriptor,v=c((e,t,r,s)=>{for(var a=s>1?void 0:s?Rt(t,r):t,o=e.length-1,i;o>=0;o--)(i=e[o])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&Et(t,r,a),a},"__decorateClass$e");let b=c(class extends L{searchId=new Date;maxWindowHeightRatio=.4;lastSearch;currentSearchDelay=100;minSearchDelay=100;maxSearchDelay=500;debounceTimeout;hideAllExtrasTimeout;minQueryLength=4;searchResultsIdentifier="search-results";apiData;input;returnKeyAction;searchAbsolute;helpButton;delete_text_button;searchWidget;progressBar;search_results_container;searchbarInnerContainer;searchbarQuerySuggestion;querySuggestionContainer;helpTextContainer;search_query_description;searchbarFooter;showAllResultsSpan;grayView;get resultsUrlString(){throw new Error("must override")}get isSearchbarFocussed(){return document.activeElement===this.input}get isSearchbarEmpty(){return!this.input.value}get isDropdownVisible(){return!this.search_results_container.classList.contains("hidden")}get query(){return this.input.value}set query(e){document.activeElement!==this.input&&this.input.focus(),this.input.value=e||"",this.input.dispatchEvent(new Event("input",{bubbles:!0})),this.input.value?this.delete_text_button.classList.remove("hidden"):(this.apiData=void 0,this.showQuerySuggestion(),this.stopProgressBar())}get jsSelectString(){return f`document.getElementsByTagName('${this.elementName}')[0]`}get isHelpVisible(){return!this.helpTextContainer.classList.contains("hidden")}get template(){return Ot}isAndroid=Ue()==="android";connectedCallback(){super.connectedCallback(),this.searchbarQuerySuggestion.innerHTML="Here's some hint about the search bar",j()?(this.minSearchDelay=500,this.maxSearchDelay=1e3,this.input.addEventListener("input",this.debounceFunction(this._onSearchbarUpdated))):this.input.addEventListener("input",this.throttleFunction(this._onSearchbarUpdated)),this.input.addEventListener("focus",()=>this.onSearchbarFocus()),this.input.addEventListener("focusout",()=>this.onSearchbarFocusout()),this.grayView.addEventListener("click",()=>this.hideAllExtras),this.helpButton.addEventListener("click",()=>this.showHelp()),this.helpButton.addEventListener("mousedown",t=>t.preventDefault()),document.addEventListener("keydown",t=>this.maybeFocusSearchbar(t)),this.input.addEventListener("keydown",t=>this.onKeyPressedEvent(t)),document.addEventListener("click",t=>this.maybeHideDropdown(t)),this.delete_text_button.addEventListener("click",t=>{this.query="",t.preventDefault()}),this.delete_text_button.addEventListener("mousedown",t=>t.preventDefault()),this.returnKeyAction.addEventListener("click",()=>this.submitSearch()),Object.defineProperty(this,"onKeyPressedEvent",{value:je}),Object.defineProperty(this,"onEnterKey",{value:Ct}),Object.defineProperty(this,"onArrowUpKey",{value:Me}),Object.defineProperty(this,"onArrowDownKey",{value:Be});const e=this.input;this.search_results_container.ontouchstart=function(t){document.activeElement===e&&e.blur()},this.helpTextContainer.ontouchstart=function(t){document.activeElement===e&&e.blur()},this.search_results_container.style.maxHeight=`${window.innerHeight-260}px`}buildResults(e){throw new Error("You need to override this")}resignFocus(){this.input.blur(),this.hideAllExtras()}showQuerySuggestion(){this.querySuggestionContainer.classList.remove("hidden"),this.search_query_description.classList.add("hidden"),this.searchbarFooter.classList.remove("display-if-necessary"),this.search_results_container.classList.add("hidden"),this.delete_text_button.classList.add("hidden")}throttleFunction(e){let t=0;return(...r)=>{clearTimeout(this.debounceTimeout);let s=new Date().getTime();if(s-t>this.currentSearchDelay)return t=s,e(...r);this.debounceTimeout=setTimeout(async()=>{e(...r)},this.minSearchDelay*2)}}debounceFunction(e){return(...t)=>{clearTimeout(this.debounceTimeout),this.debounceTimeout=setTimeout(async()=>{e(...t)},this.minSearchDelay)}}getElementById(e){let t=document.getElementById(e);if(!t)throw new Error(`failed to find element with id ${e}`);return t}createResultsDropdown(){let e=this.getElementById("search-results-container");return e.classList.add("results-dropdown"),e}maybeHideDropdown(e){this.searchWidget.contains(e.target)||this.hideAllExtras()}_onSearchbarUpdated=()=>{this.isSearchbarEmpty?(this.apiData=void 0,this.delete_text_button.classList.add("hidden"),this.stopProgressBar()):this.delete_text_button.classList.remove("hidden");let e=Math.max(4e3/this.input.value.length,this.minSearchDelay);e=Math.min(e,this.maxSearchDelay),this.currentSearchDelay=e,this.onSearchbarUpdated(),this.input.value.trim().length>this.minQueryLength?clearTimeout(this.debounceTimeout):this.stopProgressBar()};onSearchbarUpdated(){throw new Error("must override")}onKeyPressedEvent(e){}onArrowDownKey(){}onArrowUpKey(){}onEnterKey(e){}moveSearchbarHighIfMobile(){this.searchAbsolute.style.position!=="fixed"&&Lt(()=>{const e=this.searchAbsolute.getBoundingClientRect();this.input.style.caretColor="transparent",this.input.style.paddingTop="12pt",this.input.style.paddingBottom="12pt",this.searchAbsolute.style.position="fixed",this.searchAbsolute.style.top=e.top+"px",this.searchAbsolute.style.left=e.left+"px",this.searchAbsolute.style.width=e.width+"px",this.searchAbsolute.style.transform=`translateY( -${Math.abs(e.top)-22}px)`,setTimeout(()=>{this.input.style.caretColor=null},this.animateDuration)})}animateDuration=300;resetSearchbarposition(){this.searchAbsolute.style.position==="fixed"&&setTimeout(()=>{this.isSearchbarFocussed||this._resetSearchbarposition()},10)}_resetSearchbarposition(){this.input.style.paddingTop=null,this.input.style.paddingBottom=null,this.searchAbsolute.style.transform="translateY(0px)",setTimeout(()=>{this.searchAbsolute.style.position=null,this.searchAbsolute.style.top=null,this.searchAbsolute.style.left=null,this.searchAbsolute.style.width=null},this.animateDuration+1)}onSearchbarFocus(){if(Nt()&&!this.isSearchbarEmpty&&window.scrollY>0){const e=document.querySelector("html");e.style.overflowY="hidden",e.style.touchAction="none",window.scroll({top:0,behavior:"smooth"}),setTimeout(()=>{this._onSearchbarFocus()},300);return}this._onSearchbarFocus()}_onSearchbarFocus(){this.searchWidget.classList.add("focussed"),this.moveSearchbarHighIfMobile(),clearTimeout(this.hideAllExtrasTimeout),this.setGrayViewDisplayState("visible"),this.querySuggestionContainer.classList.add("hidden"),this.progressBar.classList.add("hidden"),this.isSearchbarFocussed&&(this.progressBar.classList.remove("hidden"),this.isSearchbarEmpty&&!this.isHelpVisible&&this.querySuggestionContainer.classList.remove("hidden")),this.isSearchbarEmpty||(this.apiData?this.showResultsDropdown():this._onSearchbarUpdated()),setTimeout(()=>{this.isSearchbarFocussed!==!1&&this.setGrayViewDisplayState("visible")},250)}onSearchbarFocusout(){this.searchWidget.classList.remove("focussed")}maybeFocusSearchbar(e){if(!this.isSearchbarFocussed)switch(e.key){case"/":this.input.focus(),e.preventDefault();break}}setGrayViewDisplayState(e){switch(e){case"hidden":this.grayView.classList.remove("fade-in"),this.grayView.classList.add("fade-out"),setTimeout(()=>{this.grayView.classList.add("hidden")},200);break;case"visible":this.grayView.classList.remove("hidden"),this.grayView.classList.remove("fade-out"),this.grayView.classList.add("fade-in");break}}showResultsDropdown(){this.search_results_container.classList.remove("hidden"),this.searchWidget.classList.add("normal-background"),this.searchbarFooter.classList.add("display-if-necessary"),this.search_query_description.classList.remove("hidden"),this.querySuggestionContainer.classList.add("hidden"),j()?this.isAndroid||(this.search_results_container.style.maxHeight=`${window.innerHeight-260}px`):this.search_results_container.style.maxHeight=String(window.innerHeight*this.maxWindowHeightRatio)+"px"}hideResultsDropdown(){this.hideHelp(),this.resetSearchbarposition(),this.search_results_container.classList.add("hidden"),this.searchWidget.classList.remove("normal-background"),this.searchbarFooter.classList.remove("display-if-necessary"),this.search_query_description.classList.add("hidden"),this.querySuggestionContainer.classList.add("hidden"),this.isSearchbarFocussed&&this.querySuggestionContainer.classList.remove("hidden"),setTimeout(()=>{this.isSearchbarFocussed||this.setGrayViewDisplayState("hidden")},150)}clearResultsDropdown(){this.search_results_container.innerHTML=""}hiding=!1;hideAllExtras(){if(this.hiding===!0)return;const e=document.querySelector("html");e.style.overflow=null,e.style.touchAction=null,this.hiding=!0,this.hideResultsDropdown(),this.progressBar.classList.add("hidden"),this.querySuggestionContainer.classList.add("hidden"),setTimeout(()=>{this.hiding=!1},200)}selectResultEntry(e){const r=this.search_results_container.querySelectorAll("search-result")[e];r.classList.add("selected"),this.isElementVisible(r)===!1&&r.scrollIntoView({behavior:"smooth",block:"center"})}startProgressBar(){this.progressBar.classList.add("loader-spinning")}stopProgressBar(){this.progressBar.classList.remove("loader-spinning")}showHelp(){alert("help text")}hideHelp(){this.helpTextContainer.classList.add("hidden")}submitSearch(){localStorage.setItem(this.searchResultsIdentifier,JSON.stringify(this.apiData)),this.submitSearchHandler(this.fullResultsUrl)}submitSearchHandler=e=>{window.location.href=e};get fullResultsUrl(){let e=this.input.value;return this.resultsUrlString+"?query="+e}isElementVisible(e){const t=e.getBoundingClientRect(),r=t.top;let a=t.bottom<this.search_results_container.getBoundingClientRect().bottom;return a=a&&r>this.search_results_container.getBoundingClientRect().top,a}},"BaseSearchbarElement");v([l],b.prototype,"input",2),v([l],b.prototype,"returnKeyAction",2),v([l],b.prototype,"searchAbsolute",2),v([l],b.prototype,"helpButton",2),v([l],b.prototype,"delete_text_button",2),v([l],b.prototype,"searchWidget",2),v([l],b.prototype,"progressBar",2),v([l],b.prototype,"search_results_container",2),v([l],b.prototype,"searchbarInnerContainer",2),v([l],b.prototype,"searchbarQuerySuggestion",2),v([l],b.prototype,"querySuggestionContainer",2),v([l],b.prototype,"helpTextContainer",2),v([l],b.prototype,"search_query_description",2),v([l],b.prototype,"searchbarFooter",2),v([l],b.prototype,"showAllResultsSpan",2),v([l],b.prototype,"grayView",2),b=v([m],b);const qt=b,Ue=c(()=>{const e=navigator.userAgent.toLowerCase();return/android/i.test(e)?"android":/ipad|iphone|ipod/.test(e)||navigator.platform==="macintel"&&navigator.maxTouchPoints>1?"ios":"other"},"getMobileOS"),Nt=c(()=>Ue()==="ios","isAppleSafari"),Tt=`<h6>\u{1F6DF} Route &amp; Crag Search Help</h6>
<p>You should probably try out the suggestions to get an feel of the stuff you can do before you waste time reading all this\u2026</p>
<p>\u2026but if you really want to know everything about the search, here you go:</p>
<p>Searches are checked against the following properties of a route (and the equivalents for a crag):</p>
<ul>
<li><code>name</code></li>
<li><code>crag name</code></li>
<li><code>buttress name</code></li>
<li><code>area name</code></li>
<li><code>country name</code></li>
<li><code>first ascent</code> potentially including dates and names, but could be one or the other or neither</li>
<li><code>rock type name</code> one of eg [ granite, gritstone, sandstone, limestone, schist, rhylite, ... ] (there are loads)</li>
<li><code>route type name</code> one of [ sport, trad, winter, bouldering, aid ] (this list is complete)</li>
<li><code>description</code></li>
<li><code>route grade</code></li>
<li><code>tech grade</code></li>
</ul>
<p>A match is found if all of the tokens of the search query match one or more of the fields (more on tokens later, but think &quot;words&quot; for now). This means you can very quickly write a query that returns very few results by typing a combination of fragments of the various fields, like <code>mal wom</code> returns <code>Wombat E2</code> at Malham as the first result because token1 (<code>mal</code>) matches the crag name (<code>Malham</code>) and token2 (<code>wom</code>) matches the route's name. You could be even more precise and search <code>mal wom e2</code> but for this instance it's not needed. (Note that this stuff is true at the time of writing but could change if more routes are added).</p>
<p>The scoring of results is done by applying multipliers depending on where a match is found. The higher the field is on the list above, the more valuble a match against it is considered, so if a query matches against one route's <code>name</code> and another's <code>description</code>, the one against the <code>name</code> will be considered a better match and appear nearer the top. The popularity of the route is taken into account so a route with loads of ascents will be given a higher search score than one with none.</p>
<p>For the most part this is all anyone really needs, but there are also a few advanced options you can use if you want:</p>
<ul>
<li>exact-phrase matches, eg <code>&quot;captain nemo&quot;</code></li>
<li>route-star ranges, eg <code>*-**</code></li>
<li>grade ranges, eg <code>vs-e3</code></li>
<li>date ranges, eg <code>1984-1986</code> (for first ascents - note that not all routes have fa details so these will be excluded from a search with a date range!)</li>
<li>difficulty for grade / grade quality, eg <code>|soft|</code></li>
<li>regular expressions, eg <code>/chris (?!craggs)/</code></li>
<li>negations, eg <code>-crack</code></li>
</ul>
<h6>Exact phrase matches</h6>
<p>Surround multiple words with double quotes to require a match on that phrase, eg <code>&quot;bat route&quot; malham</code> creates the tokens <code>bat route</code> and <code>malham</code>. Another example is <code>roof crack stanage</code> currently returns 45 routes, where as <code>&quot;roof crack&quot; stanage</code> returns only 9.</p>
<h6>Route-star ranges</h6>
<p>Asterisks get special treatment in search queries now. A sequence of them is considered to be a star rating for a route, so <code>*</code> is treated as 1-star, <code>**</code> treated as 2-stars and <code>***</code> treated as 3-stars. Typing just one sequence creates a search where the route is required to have at least that many stars, eg <code>bat route **</code> will only return routes with 2 or more stars that also match the other search tokens <code>bat</code> and <code>route</code>.</p>
<p>Adding a dash and a second star sequence will create a range, eg <code>*-**</code> means &quot;match routes with at least one and at most two stars&quot;.</p>
<h6>Grade ranges</h6>
<p>As above with stars, but with grades. Eg <code>vs-e1</code> will match routes with a grade of either <code>VS</code>, <code>HVS</code> or <code>E1</code>.</p>
<h6>Date ranges (only years)</h6>
<p>Date ranges will check against the first-ascent date field and require the route to have been put up between the start date and the end date (inclusive). Eg <code>1970-1974</code> will match routes put up between 01-01-1970 and 31-12-1974. You should note that not all routes have had the first ascent date filled in, and these routes will be excluded from any search that includes date ranges, so you might not get the results you expect.</p>
<h6>Difficulty for grade</h6>
<p>Not sure what to call this so we'll use &quot;difficulty for grade&quot;. We've calculated a value based on the grade voting system that assigns a route a value from one of:</p>
<ul>
<li><code>soft</code></li>
<li><code>benchmark</code></li>
<li><code>hard</code></li>
</ul>
<p>You can search for routes with these charateristics by using the special pipe-syntax, eg <code>|soft|</code>. If you don't wrap the token in pipes, you'll just be searching the other text fields, so <code>soft</code>, with no pipes, would get you a match if the token appeard in the description for example and <code>|soft|</code> will <em>only</em> match against routes that have been marked as soft, and not check the other fields for the token.</p>
<p>A continuation of this system which uses the same syntax allows you to search for routes that are voted to be a completely different grade using the following tokens:</p>
<ul>
<li><code>undergraded</code></li>
<li><code>overgraded</code></li>
</ul>
<p>eg <code>|overgraded|</code>. Note that this is based on votes, so if there are no votes for a route and you include one of these tokens it won't appear, regardless of whether it is in reality over or undergraded. Note also that whilst you can combine these with soft/benchmark/hard, doing so doesn't really make sense.</p>
<h6>Shorthands</h6>
<p>The grade quality stuff all have shorthand variants:</p>
<ul>
<li><code>|s</code> = <code>|soft|</code></li>
<li><code>|b</code> = <code>|benchmark|</code></li>
<li><code>|h</code> = <code>|hard|</code></li>
<li><code>|u</code> = <code>|undergraded|</code></li>
<li><code>|o</code> = <code>|overgraded|</code></li>
</ul>
<h6>Regular expressions</h6>
<p>Finally we reach the most pointless feature, regular expressions - we need only add an email function and this search bar will be complete.</p>
<p>Regular expressions, for those that don't know, are a way of describing patterns in strings. They are a very powerful tool for searching and manipulating text, and completely unnecessary in this search bar. However, if you do want to use them, they are possible by surrounding the expression with forward slashes, eg <code>/chris (?!craggs)/</code> will match any routes that mention <code>'chris'</code> but not those that mention <code>'chris craggs'</code>. Or <code>e2-e3 /crap|damp|horrible/</code> will return you a list of probably not classic routes.</p>
<p>Note that pure-regex queries are not allowed due to the cost of the queries against the database. You should always add any of the other query types mentioned above if you're using a regex.</p>
<h6>Negation</h6>
<p>Extra finally, if you precede any token with a minus character you will negate it and require that it is not matched, eg <code>-&quot;mark leach&quot; bat malham</code>.</p>
`;var zt=Object.defineProperty,At=Object.getOwnPropertyDescriptor,Ft=c((e,t,r,s)=>{for(var a=s>1?void 0:s?At(t,r):t,o=e.length-1,i;o>=0;o--)(i=e[o])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&zt(t,r,a),a},"__decorateClass$d");let B=new Set(Ae),pe=c(class extends qt{get resultsUrlString(){return window.location.origin+"/results/"}set query(e){super.query=e,this.input.value||this.showQuerySuggestion()}get query(){return super.query}connectedCallback(){super.connectedCallback(),this.setRandomQueryExample()}showQuerySuggestion(){const e=this.searchbarQuerySuggestion.classList.contains("hidden");super.showQuerySuggestion(),e&&this.setRandomQueryExample()}showHelp(){this.helpTextContainer.innerHTML=Tt,this.helpTextContainer.style.overflowY="auto",this.helpTextContainer.style.padding="8pt",this.helpTextContainer.style.fontSize="10pt",this.helpTextContainer.style.color="var(--subtitle-color)",this.helpTextContainer.style.paddingBottom="0px",this.helpTextContainer.classList.remove("hidden"),this.helpTextContainer.style.maxHeight=String(window.innerHeight*this.maxWindowHeightRatio)+"px",j()&&(this.helpTextContainer.style.maxHeight=`${window.innerHeight-122}px`),this.showResultsDropdown(),this.querySuggestionContainer.classList.add("hidden"),this.search_query_description.classList.add("hidden"),this.searchbarFooter.classList.remove("display-if-necessary"),this.search_results_container.classList.add("hidden"),this.input.focus()}randomQueryString="";updateRandomQuery(){this.query=this.randomQueryString}setRandomQueryExample(){B.size===0&&(B=new Set(Ae));const e=Math.floor(Math.random()*B.size),t=Array(...B.values())[e];B.delete(t);const r=t.replace(/&#8288;/g,"").replace(/&nbsp;/g," ");this.randomQueryString=r,this.searchbarQuerySuggestion.innerHTML=f`Need inspiration? How about: <a href="javascript:${this.jsSelectString}.updateRandomQuery();void(0);">${t}</a>`}fetchResults(){const e=new Date,t=this.query.trim();(async()=>{this.search_results_container.style.opacity="0.4";const s=await(await fetch(ze(),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({search_query:t,page_size:100,page:0})})).json();this.searchId.getTime()>e.getTime()||(this.stopProgressBar(),this.searchId=e,this.lastSearch=t,this.buildResults(s),this.search_results_container.style.opacity="1")})()}onSearchbarUpdated(){if(this.hideHelp(),this.startProgressBar(),this.query.trim().length===0){this.showQuerySuggestion(),this.hideResultsDropdown(),this.clearResultsDropdown();return}if(this.query.trim().length<3){this.searchbarQuerySuggestion.innerHTML="Keep typing...",this.hideResultsDropdown(),this.clearResultsDropdown();return}this.fetchResults()}showResultsDropdown(){super.showResultsDropdown(),this.setRandomQueryExample()}selectResultEntry(e){super.selectResultEntry(e),this.apiData}queue=[];buildResults(e){this.queue=[],this.clearResultsDropdown(),this.isSearchbarFocussed&&this.showResultsDropdown(),this.apiData=e,e.objects?.length===0&&J(this),e.meta.parsed_query?this.search_query_description.innerHTML=e.meta.parsed_query.queryDescription:this.search_query_description.innerHTML="";let t=0,r=0;e.objects?.forEach((s,a)=>{switch(s.type){case"route_ukc":{t++,this.queue.push(()=>{this.appendRoute(this,s)});break}case"crag_ukc":{r++,this.queue.push(()=>{this.appendCrag(this,s)});break}}t==1&&r&&this.queue.push(()=>{Fe(this,a)})}),this.showAllResultsSpan.classList.remove("hidden"),this.showAllResultsSpan.innerHTML=`Show all ${e.meta?.total_matches} results`,this.processQueue()}processQueue(){this.queue.length&&(this.queue.shift()(),Promise.resolve().then(()=>this.processQueue()))}appendCrag(e,t){return Ie({target:e,crag:t})}appendRoute(e,t){return T({target:e,route:t})}},"RouteSearchbarElement");pe=Ft([m],pe);const It=pe;var S;(e=>{class t{static identifier(n){return`crag_routes_${n}`}static fetch(n){const d=localStorage.getItem(this.identifier(n));if(d)return JSON.parse(d)}static store(n){localStorage.setItem(this.identifier(n.cragId),JSON.stringify(n))}}c(t,"RoutesForCrag"),e.RoutesForCrag=t;class r{#e;get lookup(){if(!this.#e){let n=localStorage.getItem(this.identifier);const d=JSON.parse(n);this.#e=new s(d)}return this.#e}set lookup(n){this.#e=n}fetching=!1;identifier="user_logbook";get apiUrl(){return`${N()}/v1/ukc/user/logbook`}get editDateKey(){return`${this.identifier}_edit_date`}set editDate(n){localStorage.setItem(this.editDateKey,n.getTime().toString())}get editDate(){return new Date(parseInt(localStorage.getItem(this.editDateKey)))}constructor(){}isFetching=!1;async fetch(){this.isFetching=!0;const n="ukcsid="+C.default().get("ukcsid"),P=await(await fetch(this.apiUrl,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({cookie:n,edit_date:this.editDate})})).json();for(this.isFetching=!1;this.queue.length>0;)this.queue.shift()(P);return P}queue=[];async fetchLookup(n){return this.queue.push(n),this.isFetching?Promise.resolve(void 0):this._fetchLookup()}async _fetchLookup(){if(!!C.default().get("ukcsid")){if(localStorage.getItem(this.identifier))this.fetch().then(n=>{this.loadFromRemoteDetails(n)});else{const n=await this.fetch();this.loadFromRemoteDetails(n)}return this.lookup}}loadFromRemoteDetails(n){const d=new Date(n.last_updated);this.editDate=d,this.lookup.merge(n),localStorage.setItem(this.identifier,JSON.stringify(this.lookup))}bestAscent(n){return this.lookup?.bestAscent(n)}logbookStatus(n){return this.lookup&&this.lookup?.bestAscent(n)?.simple_style_name||"unclimbed"}wishlistStatus(n){return this.lookup?this.lookup?.hasWishlist(n):!1}ascentsForRouteUkcId(n){return this.lookup?.logbook[n]||[]}get ascentEntries(){return Object.values(this.lookup?.logbook||{}).flat().sort((n,d)=>n.ascent_date.getTime()-d.ascent_date.getTime())}get wishlistEntries(){return Object.values(this.lookup?.wishlist||{}).flat()}}c(r,"LogbookDetails"),e.LogbookDetails=r;class s{logbook={};wishlist={};static styleQualities={clean:2,followed:1,dogged:0};constructor(n=null){n&&(Object.values(n.logbook).forEach(d=>d.forEach(P=>this.addAscent(P))),this.wishlist=n.wishlist)}merge(n){n.logbook.forEach(d=>this.addAscent(d)),n.wishlist.forEach(d=>this.addWishlistItem(d)),n.logbook_deletes.forEach(d=>this.deleteAscent(d)),n.wishlist_deletes.forEach(d=>this.deleteWishlistItem(d))}addAscent(n){this.logbook[n.route_id_ukc]=this.logbook[n.route_id_ukc]||[],typeof n.ascent_date=="string"&&(n=new a(n)),n.ascent_date=new Date(n.ascent_date),this.logbook[n.route_id_ukc].push(n)}addWishlistItem(n){this.wishlist[n.route_id_ukc]=this.wishlist[n.route_id_ukc]||[],this.wishlist[n.route_id_ukc].push(n)}deleteAscent(n){!this.logbook[n.route_id_ukc]||(this.logbook[n.route_id_ukc]=this.logbook[n.route_id_ukc].filter(d=>d.id!==n.ascent_id))}deleteWishlistItem(n){!this.wishlist[n.route_id_ukc]||(this.wishlist[n.route_id_ukc]=this.wishlist[n.route_id_ukc].filter(d=>d.id!==n.wishlist_id))}bestAscent(n){const d=this.logbook[n];return d?d.sort((R,xe)=>s.styleQualities[xe.simple_style_name]-s.styleQualities[R.simple_style_name])[0]:null}hasWishlist(n){return!!this.wishlist[n]}}c(s,"LogbookDetailsBacker");class a{ascent_date_ignore_day;ascent_date_ignore_month;id;ascent_date;edit_date;route_id_ukc;style_id;simple_style_name;notes;user_id_ukc;user_name;partners;ascent_style;#e;set submit_date(n){n instanceof Date?this.#e=n:this.#e=new Date(n)}get submit_date(){return this.#e}get dateString(){return this.ascent_date_ignore_month?this.ascent_date.getFullYear().toString():this.ascent_date_ignore_day?this.ascent_date.toLocaleString("default",{month:"long"})+" "+this.ascent_date.getFullYear().toString():this.ascent_date.toLocaleString("default",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}get editDateString(){return this.edit_date.toLocaleString("default",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}get shortDateString(){return this.ascent_date_ignore_month?this.ascent_date.getFullYear().toString():this.ascent_date_ignore_day?this.ascent_date.toLocaleString("default",{month:"long"})+" "+this.ascent_date.getFullYear().toString():this.ascent_date.toLocaleString("default",{year:"numeric",month:"short",day:"numeric"})}get lastClimbedDescription(){return this.ascent_date_ignore_month?`you last climbed this sometime in ${this.dateString}`:this.ascent_date_ignore_day?`you last climbed this in ${this.dateString}`:`you last climbed this on ${this.dateString}`}constructor(n){Object.assign(this,n),this.ascent_date=new Date(this.ascent_date),this.edit_date=new Date(this.edit_date)}}c(a,"AscentInfo"),e.AscentInfo=a;class o extends a{get dateString(){return this.edit_date.toLocaleString("default",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}}c(o,"WishlistInfo"),e.WishlistInfo=o,e.sharedLogbook=new e.LogbookDetails})(S||(S={})),globalThis.logbook=new S.LogbookDetails;var jt=Object.defineProperty,Bt=Object.getOwnPropertyDescriptor,Mt=c((e,t,r,s)=>{for(var a=s>1?void 0:s?Bt(t,r):t,o=e.length-1,i;o>=0;o--)(i=e[o])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&jt(t,r,a),a},"__decorateClass$c");const M=S.sharedLogbook;let Qe=c(class extends It{searchResultsIdentifier="ukc-search-results";connectedCallback(){super.connectedCallback(),M.fetchLookup(e=>this.updateLogbookAndWishlistStatusOfCells())}get resultsUrlString(){return window.location.origin.includes("localhost")?window.location.origin+"/results/":window.location.origin+"/logbook/search/"}appendCrag(e,t){return super.appendCrag(e,t)}appendRoute(e,t){const r=super.appendRoute(e,t);return r.logStatus=M.logbookStatus(t.id_ukc),r.wishlistStatus=M.wishlistStatus(t.id_ukc),r}updateLogbookAndWishlistStatusOfCells(){const e=this.getElementsByClassName("search-result");for(let t=0;t<e.length;t++){const r=e[t];r.logStatus=M.logbookStatus(r.routeIdUkc),r.wishlistStatus=M.wishlistStatus(r.routeIdUkc)}}},"UkcSearchbarElement");Qe=Mt([m],Qe);const Ht=c(e=>f`
<svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path data-target='topo-dot.stroke' fill-rule="evenodd" clip-rule="evenodd" d="M31.84 3.00003C47.9499 3.00003 61 16.0501 61 32.16C61 48.27 47.9499 61.32 31.84 61.32C15.7301 61.32 2.68 48.27 2.68 32.16C2.68 16.0501 15.7301 3.00003 31.84 3.00003Z"'/>
    <path data-target='topo-dot.fill' d="M51.6076 29.7698C50.7032 28.8654 49.3466 28.284 47.6024 28.284C45.1476 28.284 43.791 29.9636 43.791 32.4184C43.791 34.9378 45.3414 36.5528 47.7316 36.5528C49.5404 36.5528 50.6386 36.036 51.9306 35.067V38.6846C50.4448 39.5244 49.0882 39.7182 47.6024 39.7182C42.8866 39.7182 39.915 36.682 39.915 32.4184C39.915 28.0902 43.0158 25.054 47.6024 25.054C49.0882 25.054 50.4448 25.3124 51.6076 25.9584V29.7698ZM35.4576 25.3124H39.7212L35.0054 32.16L40.0442 39.5244H35.716L30.9356 32.483L35.4576 25.3124ZM27.1242 25.3124H30.871V39.5244H27.1242V25.3124ZM11.814 25.3124H15.5608V33.6458C15.5608 35.9714 16.5298 36.7466 18.2094 36.7466C19.243 36.7466 19.889 36.682 20.535 36.5528V25.3124H24.2818V39.0076C22.9898 39.3952 20.0828 39.7182 18.2094 39.7182C14.8502 39.7182 11.814 38.4262 11.814 34.421V25.3124ZM57.68 32.16C57.68 17.8834 46.1166 6.32001 31.84 6.32001C17.5634 6.32001 6.00001 17.8834 6.00001 32.16C6.00001 46.4366 17.5634 58 31.84 58C46.1166 58 57.68 46.4366 57.68 32.16Z"' />
</svg>    
`,"topoDotTemplate");var Ut=Object.defineProperty,Qt=Object.getOwnPropertyDescriptor,Z=c((e,t,r,s)=>{for(var a=s>1?void 0:s?Qt(t,r):t,o=e.length-1,i;o>=0;o--)(i=e[o])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&Ut(t,r,a),a},"__decorateClass$b");let $=c(class extends L{set colorName(e){e==="white"?this.stroke.setAttribute("fill",$.colors.black):this.stroke.setAttribute("fill",$.colors.white),this.fill.setAttribute("fill",$.colors[e])}static colors={green:"#007C57",orange:"#F39200",red:"#BE2730",black:"black",white:"white"};stroke;fill;get template(){return Ht}},"TopoDotElement");Z([g],$.prototype,"colorName",1),Z([l],$.prototype,"stroke",2),Z([l],$.prototype,"fill",2),$=Z([m],$);const Wt=$,Kt=c(e=>{const t=e;return f`
        <li class='result-entry-container'>
            <a data-target='${t.elementName}.href' href='${t.url}' style="position:relative;display:block;">
                <wishlist-indicator data-target='${t.elementName}.wishlist_indicator' alt='wishlist-indicator'></wishlist-indicator>
                <logbook-indicator data-target='${t.elementName}.logbook_indicator' color-name='green' alt='logbook-indicator'></logbook-indicator>
                <div class='result-entry'>
                    <div class="result-icon-area">
                        <topo-dot data-target='${t.elementName}.topo_dot' color-name='${t.colorName}' class='result-icon' alt='icon'></topo-dot>
                        <crag-icon data-target='${t.elementName}.crag_icon' class='result-icon' alt='icon'></crag-icon>
                    </div>
                    <div class="result-text-area">
                        <div class='result-entry-start'>
                            <div id="name-and-grade">
                                <span data-target='${t.elementName}.item_name' class='result-title'></span>
                                <div id="star-count-and-route-grade">
                                    <span data-target='${t.elementName}.star_count' class='result-star-count'></span>
                                    <span data-target='${t.elementName}.route_grade' class='result-grade'></span>
                                </div>
                            </div>
                        </div>
                        <div>
                            <div class='result-entry-end'>
                                <span data-target='${t.elementName}.crag_name' class='result-crag-name'></span>
                                <div style="margin-left:4px;">
                                    <span data-target='${t.elementName}.county_name' class='result-context'></span>
                                    <span data-target='${t.elementName}.country_name' class='result-sub-context'></span>
                                </div>
                            </div>
                            ${t.htmlForSlot("result-entry-extras")}
                        </div>
                    </div>
                </div>
            </a>
        </li>
    `},"routeTemplate");var Vt=Object.defineProperty,Yt=Object.getOwnPropertyDescriptor,p=c((e,t,r,s)=>{for(var a=s>1?void 0:s?Yt(t,r):t,o=e.length-1,i;o>=0;o--)(i=e[o])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&Vt(t,r,a),a},"__decorateClass$a");let u=c(class extends L{href;topo_dot;item_name;route_grade;star_count;crag_name;county_name;country_name;logbook_indicator;wishlist_indicator;crag_icon;extras_slot;set slugFull(e){this.href&&(this.href.href=this.url)}set itemName(e){const t=h(e);this.item_name&&(this.item_name.innerHTML=t?t+'<span id="name-dash" style="opacity:0.7;"> - </span>':"")}set routeGrade(e){this.route_grade&&(this.route_grade.innerHTML=h(e))}set starCount(e){this.star_count&&(this.star_count.innerHTML=St[e])}set cragName(e){this.crag_name&&(this.crag_name.innerHTML=h(e))}set countyName(e){this.county_name&&(this.county_name.innerHTML=h(e+", "))}set countryName(e){this.country_name&&(this.country_name.innerHTML=h(e))}set colorId(e){this.topo_dot&&(this.topo_dot.colorName=this.colorName)}set routeIdUkc(e){}get logStatus(){return"unclimbed"}get wishlistStatus(){return!1}set wishlistStatus(e){switch(e){case!0:this.classList.add("on-wishlist");break;case!1:this.classList.remove("on-wishlist");break}}set logStatus(e){switch(e){case"unclimbed":this.classList.remove("logged-clean"),this.classList.remove("logged-followed"),this.classList.remove("logged-dogged");break;case"clean":this.classList.add("logged-clean"),this.logbook_indicator.colorName="green";break;case"followed":this.classList.add("logged-followed"),this.logbook_indicator.colorName="blue";break;case"dogged":this.classList.add("logged-dogged"),this.logbook_indicator.colorName="orange";break}}get colorName(){return Object.keys(Wt.colors)[this.colorId]}_resultType="route";get resultType(){return this._resultType}set resultType(e){switch(this._resultType=e,this.hideAll(),e){case"route":this.item_name?.classList.remove("hidden"),this.topo_dot?.classList.remove("hidden"),this.route_grade?.classList.remove("hidden"),this.star_count?.classList.remove("hidden"),this.crag_name?.classList.remove("hidden"),this.county_name?.classList.remove("hidden"),this.country_name?.classList.remove("hidden");break;case"crag":this.crag_name?.classList.remove("hidden"),this.item_name?.classList.remove("hidden"),this.crag_icon?.classList.remove("hidden"),this.route_grade?.classList.remove("hidden"),this.county_name?.classList.remove("hidden"),this.country_name?.classList.remove("hidden");break;case"no-result":this.item_name?.classList.remove("hidden");break}}hideAll(){this.topo_dot?.classList.add("hidden"),this.item_name?.classList.add("hidden"),this.route_grade?.classList.add("hidden"),this.star_count?.classList.add("hidden"),this.crag_name?.classList.add("hidden"),this.county_name?.classList.add("hidden"),this.country_name?.classList.add("hidden"),this.crag_icon?.classList.add("hidden")}get url(){let e=window.location.origin;return e.match(/ukclimbing/gi)||(e="https://dev.ukclimbing.com"),`${e}/logbook/crags/${this.slugFull}`}get template(){return Kt}connectedCallback(){super.connectedCallback(),this.logbook_indicator.colorName="green"}openObject(){window.open(this.url,"_self")}},"SearchResultElement");p([l],u.prototype,"href",2),p([l],u.prototype,"topo_dot",2),p([l],u.prototype,"item_name",2),p([l],u.prototype,"route_grade",2),p([l],u.prototype,"star_count",2),p([l],u.prototype,"crag_name",2),p([l],u.prototype,"county_name",2),p([l],u.prototype,"country_name",2),p([l],u.prototype,"logbook_indicator",2),p([l],u.prototype,"wishlist_indicator",2),p([l],u.prototype,"crag_icon",2),p([l],u.prototype,"extras_slot",2),p([g],u.prototype,"slugFull",1),p([g],u.prototype,"itemName",1),p([g],u.prototype,"routeGrade",1),p([g],u.prototype,"starCount",1),p([g],u.prototype,"cragName",1),p([g],u.prototype,"countyName",1),p([g],u.prototype,"countryName",1),p([g],u.prototype,"colorId",1),p([g],u.prototype,"routeIdUkc",1),p([g],u.prototype,"logStatus",1),p([g],u.prototype,"wishlistStatus",1),u=p([m],u);const We=u,Jt=c(e=>f`
<svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path id="routeTickedIndicator-bezier2" stroke="none" fill="rgba(255, 255, 255, 1)" d="M 50,0 C 50,-0 50,50 50,50 L 0,-0 50,-0 50,0 Z M 50,0" />
    <path data-target='logbook-indicator.fill' d="M 50,0 C 50,-0 50,0.73 50,2.02 49.46,2.56 48.74,3.27 47.93,4.09 44.06,7.94 37.97,14.01 37.97,14.01 L 32.12,8.16 C 31.76,7.81 31.26,7.61 30.76,7.61 30.26,7.61 29.77,7.81 29.41,8.16 L 26.7,10.86 C 26.34,11.22 26.14,11.71 26.14,12.21 26.14,12.7 26.34,13.2 26.7,13.56 L 33.91,20.74 36.62,23.44 C 36.98,23.79 37.47,23.99 37.97,23.99 38.47,23.99 38.97,23.79 39.33,23.44 L 42.04,20.74 C 42.04,20.74 46.16,16.64 50,12.82 50,27.63 50,50 50,50 L 0,-0 50,-0 50,0 Z M 50,0"/>
</svg>
`,"logbookIndicatorTemplate");var Zt=Object.defineProperty,Gt=Object.getOwnPropertyDescriptor,G=c((e,t,r,s)=>{for(var a=s>1?void 0:s?Gt(t,r):t,o=e.length-1,i;o>=0;o--)(i=e[o])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&Zt(t,r,a),a},"__decorateClass$9");let E=c(class extends L{set colorName(e){this.fill.setAttribute("fill",E.colors[e])}static colors={green:"#007C57",orange:"#FF8C22",blue:"#2A66B5"};stroke;fill;get template(){return Jt}},"LogbookIndicatorElement");G([g],E.prototype,"colorName",1),G([l],E.prototype,"stroke",2),G([l],E.prototype,"fill",2),E=G([m],E);const Xt=E,er=c(e=>{const t=e;return f`
        <li class='result-entry-container'>
            <a data-target='${t.elementName}.href' href='${t.url}' style="position:relative;display:block;">
                <wishlist-indicator data-target='${t.elementName}.wishlist_indicator' alt='wishlist-indicator'></wishlist-indicator>
                <logbook-indicator data-target='${t.elementName}.logbook_indicator' color-name='green' alt='logbook-indicator'></logbook-indicator>
                <div class='result-entry d-flex flex-column align-items-start'>
                    <div class='d-flex flex-row w-100 w-md-0'>
                        <div class="result-icon-area">
                            <topo-dot data-target='${t.elementName}.topo_dot' color-name='${t.colorName}' class='result-icon' alt='icon'></topo-dot>
                            <crag-icon data-target='${t.elementName}.crag_icon' class='result-icon' alt='icon'></crag-icon>
                        </div>
                        <div class='result-entry-start w-100 w-md-0 pl-1 pl-md-0'>
                            <div id="name-and-grade">
                                <span data-target='${t.elementName}.item_name' class='result-title'></span>
                                <div id="star-count-and-route-grade">
                                    <span data-target='${t.elementName}.star_count' class='result-star-count pl-2 pl-md-0'></span>
                                    <span data-target='${t.elementName}.route_grade' class='result-grade'></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="result-text-area">
                        <div class='w-100'>
                            <div class='ascent-area'>
                                <div class='result-entry-end align-items-baseline justify-content-start d-flex d-md-none flex-row pl-0'>
                                    <span data-targets='${t.elementName}.crag_names' class='result-crag-name'></span>
                                    <div class='' style="margin-left:4px;">
                                        <span data-targets='${t.elementName}.county_names' class='result-context'></span>
                                        <span data-targets='${t.elementName}.country_names' class='result-sub-context'></span>
                                    </div>
                                </div>
                                <div data-target='${t.elementName}.ascent_notes' class='ascent-notes' hidden>
                                </div>
                                <div class='ascent-details justify-content-space-between align-items-baseline'>
                                    <div class='ascent-details-start'>
                                        <span data-target='${t.elementName}.ascent_style_indicator' class='ascent-style-indicator'>●</span>
                                        <span data-target='${t.elementName}.ascensionist'></span>
                                        <span data-target='${t.elementName}.ascent_style'></span>
                                        <span data-target='${t.elementName}.partner_names_with'>with</span>
                                        <span data-target='${t.elementName}.partner_names'></span>
                                        <span data-target='${t.elementName}.ascent_date'></span>
                                    </div>
                                    <div class='result-entry-end align-items-baseline justify-content-end d-none d-md-flex flex-row'>
                                        <span data-targets='${t.elementName}.crag_names' class='result-crag-name'></span>
                                        <div class='' style="margin-left:4px;">
                                            <span data-targets='${t.elementName}.county_names' class='result-context'></span>
                                            <span data-targets='${t.elementName}.country_names' class='result-sub-context'></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </a>
        </li>
    `},"logentryTemplate");var tr=Object.defineProperty,rr=Object.getOwnPropertyDescriptor,_=c((e,t,r,s)=>{for(var a=s>1?void 0:s?rr(t,r):t,o=e.length-1,i;o>=0;o--)(i=e[o])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&tr(t,r,a),a},"__decorateClass$8");let y=c(class extends We{ascensionist;partner_names;partner_names_with;ascent_style_indicator;ascent_style;ascent_notes;ascent_date;crag_names;county_names;country_names;set cragName(e){this.crag_names&&this.crag_names.forEach(t=>t.innerHTML=h(e))}set countyName(e){this.county_names&&this.county_names.forEach(t=>t.innerHTML=h(e)+", ")}set countryName(e){this.country_names&&this.country_names.forEach(t=>t.innerHTML=h(e))}set ascentNotes(e){this.ascent_notes&&(this.ascent_notes.hidden=!e,this.ascent_notes.innerHTML=`&ldquo;${h(e?.trim())}&rdquo;`)}set ascentStyle(e){this.ascent_style&&(this.ascent_style.innerText=e)}set ascentStyleSimple(e){let t="";switch(e){case"clean":t="green";break;case"followed":t="blue";break;case"dogged":t="orange";break;default:t="green";break}this.ascent_style_indicator.style.color=Xt.colors[t]}set ascensionistDetails(e){this.ascensionist.innerHTML=`<a href='/logbook/logbook/?user_id=${e.id}'>${h(e.name)}</a>`}set partners(e){this.partner_names_with&&(this.partner_names_with.hidden=e.length===0);const t=e.map(r=>r.id?`<a href='/logbook/logbook/?user_id=${r.id}'>${r.name}</a>`:r?.name);this.partner_names.innerHTML=h(t.join(", "))}get template(){return er}},"LogbookResultElement");_([l],y.prototype,"ascensionist",2),_([l],y.prototype,"partner_names",2),_([l],y.prototype,"partner_names_with",2),_([l],y.prototype,"ascent_style_indicator",2),_([l],y.prototype,"ascent_style",2),_([l],y.prototype,"ascent_notes",2),_([l],y.prototype,"ascent_date",2),_([W],y.prototype,"crag_names",2),_([W],y.prototype,"county_names",2),_([W],y.prototype,"country_names",2),_([g],y.prototype,"cragName",1),_([g],y.prototype,"countyName",1),_([g],y.prototype,"countryName",1),_([g],y.prototype,"ascentNotes",1),_([g],y.prototype,"ascentStyle",1),_([g],y.prototype,"ascentStyleSimple",1),y=_([m],y);const sr=c(e=>{const t=e;return f`
        <li class='result-entry-container'>
            <a data-target='${t.elementName}.href' href='${t.url}' style="position:relative;display:block;">
                <wishlist-indicator data-target='${t.elementName}.wishlist_indicator' alt='wishlist-indicator'></wishlist-indicator>
                <logbook-indicator data-target='${t.elementName}.logbook_indicator' color-name='green' alt='logbook-indicator'></logbook-indicator>
                <div class='result-entry d-flex flex-column align-items-start'>
                    <div class='d-flex flex-row w-100 w-md-0'>
                        <div class="result-icon-area">
                            <topo-dot data-target='${t.elementName}.topo_dot' color-name='${t.colorName}' class='result-icon' alt='icon'></topo-dot>
                        </div>
                        <div class='result-entry-start w-100 w-md-0 pl-1 pl-md-0'>
                            <div id="name-and-grade">
                                <span data-target='${t.elementName}.item_name' class='result-title'></span>
                                <div id="star-count-and-route-grade">
                                    <span data-target='${t.elementName}.star_count' class='result-star-count pl-2 pl-md-0'></span>
                                    <span data-target='${t.elementName}.route_grade' class='result-grade'></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="result-text-area">
                        <div class='w-100'>
                            <div class='ascent-area'>
                                <div data-target='${t.elementName}.route_description' class='ascent-notes' hidden></div>
                                <div class='ascent-details justify-content-space-between align-items-baseline'>
                                    <div class='ascent-details-start'>
                                        <span data-target='${t.elementName}.fa_details' class="font-italic"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </a>
        </li>
    `},"routeResultTemplate");var ar=Object.defineProperty,or=Object.getOwnPropertyDescriptor,X=c((e,t,r,s)=>{for(var a=s>1?void 0:s?or(t,r):t,o=e.length-1,i;o>=0;o--)(i=e[o])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&ar(t,r,a),a},"__decorateClass$7");let H=c(class extends We{ascensionist;route_description;fa_details;set routeDescription(e){this.route_description&&(this.route_description.hidden=!e,this.route_description.innerHTML=h(e?.trim()||""))}set faDetails(e){if(this.fa_details){this.fa_details.hidden=!e;const t=e?.trim();this.fa_details.innerHTML=h(t)}}get template(){return sr}},"RouteResultElement");X([l],H.prototype,"ascensionist",2),X([l],H.prototype,"route_description",2),X([l],H.prototype,"fa_details",2),H=X([m],H);var ir=Object.defineProperty,nr=Object.getOwnPropertyDescriptor,cr=c((e,t,r,s)=>{for(var a=s>1?void 0:s?nr(t,r):t,o=e.length-1,i;o>=0;o--)(i=e[o])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&ir(t,r,a),a},"__decorateClass$6");const z=S.sharedLogbook;let ge=c(class extends Dt{get searchbarTag(){return"ukc-searchbar"}searchResultsIdentifier="ukc-search-results";connectedCallback(){super.connectedCallback(),z.fetchLookup(e=>this.updateLogbookAndWishlistStatusOfCells())}appendRoute(e,t){const r=super.appendRoute(e,t);r.logStatus=z.logbookStatus(t.id_ukc);const s=z.bestAscent(t.id_ukc);return s?r.setAttribute("title",s.lastClimbedDescription):r.setAttribute("title","not in your logbook"),r.wishlistStatus=z.wishlistStatus(t.id_ukc),r}updateLogbookAndWishlistStatusOfCells(){const e=this.getElementsByClassName("search-result");for(let t=0;t<e.length;t++){const r=e[t];r.logStatus=z.logbookStatus(r.routeIdUkc),r.wishlistStatus=z.wishlistStatus(r.routeIdUkc)}}get template(){return e=>f`
        <style>
          #breadcrumb-container .d-flex {
            display: none !important;
          }
          .bg-danger {
            display: none;
          }
        </style>
        ${super.template(e)}
      `}},"UkcResultsElement");ge=cr([m],ge);const lr=ge;var dr=Object.defineProperty,hr=Object.getOwnPropertyDescriptor,ur=c((e,t,r,s)=>{for(var a=s>1?void 0:s?hr(t,r):t,o=e.length-1,i;o>=0;o--)(i=e[o])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&dr(t,r,a),a},"__decorateClass$5");const fe=S.sharedLogbook,pr=c(()=>`${N()}/v1/rockfax/search/logbook`,"generateApiUrl$3");let me=c(class extends lr{searchBarPlaceholderString="Search all routes/crags...";get apiUrl(){return pr()}lastHeaderString="";get sortOrderKey(){return"logbook_sort_order"}get defaultSortOrder(){return"date"}connectedCallback(){this.innerHTML||=this.template(this),super.connectedCallback(),this.sort_button.style.display="block",this.sort_order.style.display="block",this.input.placeholder="Filter your logbook...",document.addEventListener("DOMContentLoaded",()=>{this.searchBar.submitSearchHandler=e=>{window.location.href=e},this.input.value=this.urlFilter||"",this.searchBar.input.value=""})}queryToUseDuringInit(){return this.urlFilter||""}searchResultsIdentifier="ukc-logbook";get allowEmptyQuery(){return!0}get userIdFromUrl(){const t=new URLSearchParams(window.location.search).get("user_id");return t?parseInt(t):C.default().userIdUkc}get userIdForRequest(){return this.userIdFromUrl||C.default().userIdUkc}appendHeader(e,t,r,s){const a=document.createElement("div");a.classList.add("date-header");const o=document.createElement("span");o.innerText=e,a.appendChild(o);const i=document.createElement("span"),n=s[t===1?"singular":"plural"];return i.innerText=`${t} ${n}`,a.appendChild(i),r.search_results_container.appendChild(a),a}appendRoute(e,t,r){const s=T({target:e,route:t,tagName:"logbook-result"}),a=fe.bestAscent(t.id_ukc);s.logStatus=fe.logbookStatus(t.id_ukc),s.setAttribute("title",a?.lastClimbedDescription||"not in your logbook");const o=new S.AscentInfo(t.associated_ascent_entry);return o&&(s.ascentStyleSimple=h(o.simple_style_name||"unknown"),s.partners=o.partners,s.ascentStyle=o.ascent_style?.short_name||"unknown",s.ascentNotes=o.notes,s.ascent_date.innerText=this.sort_order.value==="date"?"":o.shortDateString),s.wishlistStatus=fe.wishlistStatus(t.id_ukc),s}async fetchResultsForPage(e,t){this.lastHeaderString="";const r=await super.fetchResultsForPage(e,t);if(!!this.response)return this.response.status===401?(this.responseMessage=r.error,r):(r.meta?.is_third_party&&(this.input.placeholder=`Filter ${r.meta.user_name_short}'s logbook...`),this.search_results_title.innerHTML=`<span style="font-size: 0.8em">Logbook for <a href="/user/profile.php?id=${r.meta?.user_id}">${h(r.meta?.user_name||"")}</a></span>`,r)}bodyForRequest(e,t){const r=super.bodyForRequest(e,t);return r.user_id=this.userIdForRequest,r}htmlForSlot(e){return e==="ukc-search-results-sort-order-options"?f`
        <option value="date"      >Order by ascent date</option>
        <option value="crag_name" >Order by crag name</option>
        <option value="style"     >Order by ascent style</option>
        <option value="grade"     >Order by route grade</option>
        <!--<option value="voted_grade">Order by voted grade</option>-->
      `:""}buildResults(e){const t=e;if(console.dir(t,{depth:null}),this.queue=[],this.clearResultsDropdown(),this.apiData=t,this.page_control.pageCount=t.meta?.total_pages,this.page_control.currentPage=t.meta?.page,t.objects?.length===0&&J(this),this.search_query_description)if(t.meta?.parsed_query){const r=t.meta?.total_matches;this.search_query_description.innerHTML=t.meta.parsed_query.queryDescription+` (${r}&nbsp;match${r===1?"":"es"})`}else this.search_query_description.innerHTML="";if(this.response.status===401){this.search_results_container.innerHTML=this.privateDivString();return}t.objects.forEach(r=>{this.queue.push(()=>{let s=r.title;this.appendHeader(s,r.routes.length,this,t.meta.object_return_type.name)}),r.routes.forEach(s=>{this.queue.push(()=>{this.appendRoute(this,s)})})}),this.processQueue()}privateDivString(){return f`
    <div class='d-flex w-75 mx-auto justify-content-center pt-5 pb-5' style='opacity:0.5;'><i class="fas fa-do-not-enter pr-2 mt-1"></i>${this.responseMessage}</div>
    `}},"UkcLogbookElement");me=ur([m],me);const be=me;var gr=Object.defineProperty,fr=Object.getOwnPropertyDescriptor,mr=c((e,t,r,s)=>{for(var a=s>1?void 0:s?fr(t,r):t,o=e.length-1,i;o>=0;o--)(i=e[o])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&gr(t,r,a),a},"__decorateClass$4");const ye=S.sharedLogbook,br=c(()=>`${N()}/v1/rockfax/search/wishlist`,"generateApiUrl$2");let Ke=c(class extends be{get apiUrl(){return br()}ascentsByDateLookup={};get sortOrderKey(){return"wishlist_sort_order"}get defaultSortOrder(){return"date"}connectedCallback(){super.connectedCallback(),this.sort_button.style.display="block",this.sort_order.style.display="block",this.input.placeholder="Filter your wishlist..."}searchResultsIdentifier="ukc-wishlist";get allowEmptyQuery(){return!0}appendRoute(e,t,r){const s=T({target:e,route:t,tagName:"logbook-result"}),a=ye.bestAscent(t.id_ukc);s.logStatus=ye.logbookStatus(t.id_ukc),s.setAttribute("title",a?.lastClimbedDescription||"not in your logbook");const o=new S.WishlistInfo(t.associated_ascent_entry);return s.partner_names_with.hidden=!0,o&&(s.ascentStyleSimple=o.simple_style_name||"unknown",s.ascent_style_indicator.style.display="none",s.ascentNotes=o.notes),s.wishlistStatus=ye.wishlistStatus(t.id_ukc),s}async fetchResultsForPage(e,t){const r=await super.fetchResultsForPage(e,t);return this.response.status===401||(r.meta?.is_third_party&&(this.input.placeholder=`Filter ${h(r.meta?.user_name_short||"")}'s wishlist...`),this.search_results_title.innerHTML=`<span style="font-size: 0.8em">Wishlist for <a href="/user/profile.php?id=${r.meta?.user_id}">${h(r.meta?.user_name||"")}</a></span>`),r}bodyForRequest(e,t){const r=super.bodyForRequest(e,t);return r.user_id=this.userIdForRequest,r.sort_by=this.sort_order.value,r}htmlForSlot(e){return e==="ukc-search-results-sort-order-options"?f`
        <option value="date"      >Order by date added</option>
        <option value="crag_name" >Order by crag name</option>
        <option value="grade"     >Order by route grade</option>
        <!--<option value="voted_grade">Order by voted grade</option>-->
      `:""}},"UkcWishlistElement");Ke=mr([m],Ke);var yr=Object.defineProperty,vr=Object.getOwnPropertyDescriptor,_r=c((e,t,r,s)=>{for(var a=s>1?void 0:s?vr(t,r):t,o=e.length-1,i;o>=0;o--)(i=e[o])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&yr(t,r,a),a},"__decorateClass$3");const ve=S.sharedLogbook,wr=c(()=>`${N()}/v1/rockfax/search/partner_ascents`,"generateApiUrl$1");let Ve=c(class extends be{get apiUrl(){return wr()}ascentsByDateLookup={};get sortOrderKey(){return"partner_ascents_sort_order"}get defaultSortOrder(){return"date"}connectedCallback(){super.connectedCallback(),this.sort_button.style.display="block",this.sort_order.style.display="block",this.input.placeholder="Filter your partners' ascents..."}searchResultsIdentifier="ukc-partner-ascents";get allowEmptyQuery(){return!0}appendRoute(e,t,r){const s=T({target:e,route:t,tagName:"logbook-result"}),a=ve.bestAscent(t.id_ukc);s.logStatus=ve.logbookStatus(t.id_ukc),s.setAttribute("title",a?.lastClimbedDescription||"not in your logbook");const o=new S.AscentInfo(t.associated_ascent_entry);return o&&(s.ascentStyleSimple=o.simple_style_name||"unknown",s.ascentNotes=o.notes,s.ascensionistDetails={name:o.user_name,id:o.user_id_ukc},s.partners=o.partners,s.ascentStyle=o.ascent_style?.short_name||"unknown",s.ascent_date.innerText=this.sort_order.value==="date"?"":o.shortDateString),s.wishlistStatus=ve.wishlistStatus(t.id_ukc),s}async fetchResultsForPage(e,t){const r=await super.fetchResultsForPage(e,t);return this.response.status===401||(r.meta?.is_third_party?this.input.placeholder=`Filter ${r.meta?.user_name_short}'s partners' ascents...`:this.input.placeholder="Filter your partners' ascents...",this.search_results_title.innerHTML=`<span style="font-size: 0.8em">Recent partner ascents for <a href="/user/profile.php?id=${r.meta?.user_id}">${h(r.meta?.user_name||"")}</a></span>`),r}bodyForRequest(e,t){const r=super.bodyForRequest(e,t);return r.user_id=this.userIdForRequest,r.sort_by=this.sort_order.value,r}htmlForSlot(e){return e==="ukc-search-results-sort-order-options"?f`
        <option value="date"      >Order by ascent date</option>
        <option value="crag_name" >Order by crag name</option>
        <option value="grade"     >Order by route grade</option>
        <option value="user_name" >Order by partner</option>
        <!--<option value="voted_grade">Order by voted grade</option>-->
      `:""}},"UkcPartnerAscentsElement");Ve=_r([m],Ve);var kr=Object.defineProperty,Sr=Object.getOwnPropertyDescriptor,Ye=c((e,t,r,s)=>{for(var a=s>1?void 0:s?Sr(t,r):t,o=e.length-1,i;o>=0;o--)(i=e[o])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&kr(t,r,a),a},"__decorateClass$2");const xr=c(()=>`${N()}/v1/rockfax/search/route_ukc_for_crag`,"generateApiUrl"),_e=S.sharedLogbook;let we=c(class extends be{get apiUrl(){return xr()}lastCell=null;loadedCellCount=0;cellsToLoadAtATime=50;cellsLastLoadedAt=new Date().getTime();loadedRoutes=new Set;cragId;searchResultsIdentifier="routes-viewer";isInitialFetchComplete=!1;routesLookup;get sortOrderKey(){return"routes_viewer_sort_order"}get defaultSortOrder(){return"ltr"}connectedCallback(){super.connectedCallback(),this.sort_button.style.display="block",this.sort_order.style.display="block",this.input.placeholder="Filter routes at this crag...",this.sort_order.value=this.urlSortOrder||this.savedSortOrder,document.addEventListener("scroll",async e=>{const t=this.lastCell?.getBoundingClientRect().top,r=new Date().getTime();r-this.cellsLastLoadedAt>500&&t&&t<window.innerHeight+400&&(this.cellsLastLoadedAt=r,this.loadCellsForObjectsWithIdsReturn(this.apiData))}),this.page_control.style.display="none",this.performInitialFetch()}async performInitialFetch(){const e=this.bodyForRequest("",0);e.return_type="full";const t=this.bodyForRequest(this.urlFilter,0);t.return_type="ids";const r=fetch(this.apiUrl,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}),s=fetch(this.apiUrl,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}),[a,o]=await Promise.all([r,s]),[i,n]=await Promise.all([a.json(),o.json()]);this.routesLookup=this.buildRoutesLookup(i),i.objects=this.buildIdsSectionArray(i),this.baseData=i,this.search_results_title.innerHTML=`<span style="font-size: 0.8em">Routes at ${h(i.meta.crag_name||"")}</span>`,this.buildResults(n),this.isInitialFetchComplete=!0}buildIdsSectionArray(e){return e.objects.map(t=>({title:t.title,routes:t.routes,ids:t.routes.map(r=>r.id_ukc)}))}get allowEmptyQuery(){return!0}async fetchResultsForPage(e,t){if(!this.isInitialFetchComplete)return{meta:{},objects:[]};this.lastHeaderString="";const r=await super.fetchResultsForPage(e,t);return this.search_results_title.innerHTML=`<span style="font-size: 0.8em">Routes at ${h(r.meta.crag_name||"")}</span>`,r}bodyForRequest(e,t){const r=Object.keys(this.routesLookup?.routes||{}).length?"ids":"full";return{cookie:C.default().cookie,search_query:e,sort_by:this.sort_order.value,direction:this.sortDirectionFromButton,return_type:r,crag_id:Number(this.cragId)}}htmlForSlot(e){return e==="ukc-search-results-sort-order-options"?f`
        <option value="ltr" >Order left to right</option>
        <option value="grade" >Order by route grade</option>
        <!--<option value="voted_grade">Order by voted grade</option>-->
      `:""}buildResults(e){if(!e)return;this.loadedRoutes=new Set;const t=e;if(this.loadedCellCount=0,console.dir(t,{depth:null}),this.queue=[],this.clearResultsDropdown(),this.page_control.pageCount=t.meta?.total_pages,this.page_control.currentPage=t.meta?.page,t.objects?.length===0&&J(this),this.search_query_description)if(t.meta?.parsed_query){const r=t.meta?.total_matches;this.search_query_description.innerHTML=t.meta.parsed_query.queryDescription+` (${r}&nbsp;match${r===1?"":"es"})`}else this.search_query_description.innerHTML="";if(this.response?.status===401){this.search_results_container.innerHTML=this.privateDivString();return}this.apiData=t,this.loadCellsForObjectsWithIdsReturn(t)}loadCellsForObjectsWithIdsReturn(e){if(!e)return;const t=e.objects;let r=0;t.forEach(s=>{r>this.cellsToLoadAtATime||(this.loadedRoutes.has(s.ids[0])||this.queue.push(()=>{let a=s.title;this.appendHeader(a,s.ids.length,this,e.meta.object_return_type.name)}),s.ids.forEach(a=>{r>this.cellsToLoadAtATime||this.loadedRoutes.has(a)||(this.loadedRoutes.add(a),r++,this.queue.push(()=>{const o=this.routesLookup?.routes[a];if(o){const i=this.appendRoute(this,o);this.queue.length||(this.lastCell=i)}else console.log("missing route",a)}))}))}),this.processQueue()}buildRoutesLookup(e){const t={},r={cragId:this.cragId,routes:t,lastUpdated:new Date};return e.objects.forEach(s=>{s.routes.forEach(a=>{t[a.id_ukc]=a})}),r}loadCellsForObjectsWithFullReturn(e){if(!e)return;const t=e.objects;let r=0;t.forEach(s=>{r>this.cellsToLoadAtATime||(s.routes[0]?.isLoaded||this.queue.push(()=>{let a=s.title;this.appendHeader(a,s.routes.length,this,e.meta.object_return_type.name)}),s.routes.forEach(a=>{if(r>this.cellsToLoadAtATime)return;const o=a;o.isLoaded||(o.isLoaded=!0,r++,this.queue.push(()=>{const i=this.appendRoute(this,a);this.queue.length||(this.lastCell=i)}))}))}),this.processQueue()}appendRoute(e,t,r){const s=T({target:e,route:t,tagName:"route-result"}),a=_e.bestAscent(t.id_ukc);return s.logStatus=_e.logbookStatus(t.id_ukc),s.setAttribute("title",h(a?.lastClimbedDescription)||"not in your logbook"),s.routeDescription=h(t.description_string_rockfax||t.description_string),s.faDetails=h(t.first_ascent_string),s.wishlistStatus=_e.wishlistStatus(t.id_ukc),s}},"RoutesViewerElement");Ye([g],we.prototype,"cragId",2),we=Ye([m],we);const Lr=c(e=>f`
<svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path data-target='crag-icon.stroke' fill-rule="evenodd" clip-rule="evenodd" d="M35.2797 13.6441C36.5208 11.8103 38.5673 10.7879 40.6491 10.7879C42.7304 10.7879 44.7598 11.8813 45.9602 13.6813L45.9703 13.6964L62.1445 38.4495C65.1097 42.9245 61.3358 47.8788 56.9047 47.8788H6.53211C1.71195 47.8788 -1.67085 42.6244 1.08555 38.2616L1.09176 38.2518L18.4137 11.1955C19.7424 9.03294 22.0318 8.12122 24.0381 8.12122C26.0129 8.12122 28.2465 9.06783 29.5495 11.1478L33.2254 16.6014L35.2797 13.6441Z" fill="black"/>
    <path data-target='crag-icon.fill' d="M58.9054 40.5833L42.7332 15.8333C42.233 15.0833 41.3994 14.6667 40.6491 14.6667C39.8155 14.6667 38.9819 15.0833 38.4817 15.8333L33.1772 23.4697L26.2888 13.25C25.7887 12.4167 24.8717 12 24.0381 12C23.1211 12 22.2041 12.4167 21.704 13.25L4.36471 40.3333C3.36437 41.9167 4.53143 44 6.53211 44H56.9047C58.7386 44 59.9057 42.0833 58.9054 40.5833Z" fill="white"/>
    <line data-target='crag-icon.stroke' x1="32.7288" y1="18.7442" x2="38.7442" y2="29.2712" stroke="black" stroke-width="4" stroke-linecap="round"/>
</svg>
`,"cragIconTemplate");var Cr=Object.defineProperty,$r=Object.getOwnPropertyDescriptor,ke=c((e,t,r,s)=>{for(var a=s>1?void 0:s?$r(t,r):t,o=e.length-1,i;o>=0;o--)(i=e[o])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&Cr(t,r,a),a},"__decorateClass$1");let ee=c(class extends L{stroke;fill;get template(){return Lr}},"CragIconElement");ke([l],ee.prototype,"stroke",2),ke([l],ee.prototype,"fill",2),ee=ke([m],ee);const Pr=c(e=>f`
<svg viewBox="0 0 120 120" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path id="routeWishList-bezier2" stroke="none" fill="#F8CA23" d="M 69.15,86 C 68.23,86 67.26,85.71 66.2,85.11 L 45.02,74.03 23.75,85.14 C 21.79,86.24 19.9,86.28 18.53,85.24 17.55,84.51 16.5,83.05 17.01,80.24 L 21.03,56.68 3.96,40.02 C 1.82,38.01 1.81,36.2 2.19,35.03 2.58,33.87 3.62,32.42 6.44,32.05 L 30.17,28.59 40.82,7.09 C 42.08,4.54 43.78,4 44.98,4 46.17,4 47.86,4.53 49.16,7.06 L 59.84,28.59 83.58,32.06 C 86.37,32.42 87.42,33.86 87.81,35.01 88.18,36.17 88.2,37.94 86.22,39.98 L 68.96,56.68 72.99,80.26 C 73.51,83.04 72.45,84.51 71.47,85.24 70.81,85.74 70.01,86 69.15,86 Z M 69.15,86" />
</svg>
`,"wishlistIndicatorTemplate");var Dr=Object.defineProperty,Or=Object.getOwnPropertyDescriptor,Se=c((e,t,r,s)=>{for(var a=s>1?void 0:s?Or(t,r):t,o=e.length-1,i;o>=0;o--)(i=e[o])&&(a=(s?i(t,r,a):i(a))||a);return s&&a&&Dr(t,r,a),a},"__decorateClass");let te=c(class extends L{stroke;fill;get template(){return Pr}},"WishlistIndicatorElement");Se([l],te.prototype,"stroke",2),Se([l],te.prototype,"fill",2),te=Se([m],te)})();
